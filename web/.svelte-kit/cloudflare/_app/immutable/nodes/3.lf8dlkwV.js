import"../chunks/DsnmJJEf.js";import{p as oe,d as ie,c as q,b as G,a as v,n as _e,an as ee,a9 as ae,D as me,aa as R,I as e,f as x,am as z,P as Ee,M as s,O as c,ao as ze,al as F,N as t,L as B,ap as Fe}from"../chunks/bOSu8_9I.js";import{s as ge,a as p}from"../chunks/Ctk_jbRy.js";import{i as w}from"../chunks/C3RYBViL.js";import{I as he,e as pe,s as xe,a as qe}from"../chunks/CNoyRSNi.js";import{h as Ge}from"../chunks/Bha2itWB.js";import{s as te}from"../chunks/BLtbU3fE.js";import{g as He,s as Ke}from"../chunks/BL3PLj43.js";import{C as re}from"../chunks/BhsAfQsw.js";import{s as ye,r as we}from"../chunks/Di9dn3sX.js";import{L as Ve}from"../chunks/CAAZjQWN.js";import{E as Je}from"../chunks/D3M7jnZE.js";import{C as Qe,a as We}from"../chunks/8w5CS6qf.js";function Xe(L,n){oe(n,!0);let b=we(n,["$$slots","$$events","$$legacy"]);const _=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];he(L,ye({name:"arrow-right"},()=>b,{get iconNode(){return _},children:(D,N)=>{var g=q(),U=G(g);ge(U,()=>n.children??_e),v(D,g)},$$slots:{default:!0}})),ie()}function se(L,n){oe(n,!0);let b=we(n,["$$slots","$$events","$$legacy"]);const _=[["circle",{cx:"12",cy:"12",r:"3"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12"}]];he(L,ye({name:"git-commit-horizontal"},()=>b,{get iconNode(){return _},children:(D,N)=>{var g=q(),U=G(g);ge(U,()=>n.children??_e),v(D,g)},$$slots:{default:!0}})),ie()}var Ye=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-sm">No recent deployments</p></div>'),Ze=x('<a class="flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 transition-colors"><div class="shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-white truncate"> </span> <span> </span></div> <div class="text-xs text-gray-500 truncate"> </div></div> <div class="shrink-0 text-xs text-gray-500"> </div></a>'),$e=x('<div class="divide-y divide-gray-800"></div>'),ea=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-sm">No recent commits</p></div>'),aa=x('<span class="text-xs text-gray-500 font-mono"> </span>'),ta=x('<span class="font-mono"> </span>'),ra=x('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 transition-colors"><div class="shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-white truncate"> </span> <!></div> <div class="text-xs text-gray-500 truncate"><!></div></div> <div class="shrink-0 flex items-center gap-2 text-xs text-gray-500"><span> </span> <!></div></a>'),sa=x('<div class="divide-y divide-gray-800"></div>'),oa=x('<div class="flex-1 flex flex-col lg:flex-row min-h-0 h-full overflow-hidden gap-4 lg:gap-6 p-4"><div class="flex-1 flex flex-col border border-gray-800 rounded-lg min-w-0 overflow-hidden"><div class="shrink-0 px-4 py-3 border-b border-gray-800 flex items-center justify-between"><div class="flex items-center gap-2 text-gray-400"><!> <span class="text-sm font-medium">Recent Deployments</span></div> <a href="/deployments" class="text-xs text-gray-500 hover:text-gray-300 flex items-center gap-1">View all <!></a></div> <div class="flex-1 overflow-y-auto"><!></div></div> <div class="flex-1 flex flex-col border border-gray-800 rounded-lg min-w-0 overflow-hidden"><div class="shrink-0 px-4 py-3 border-b border-gray-800 flex items-center justify-between"><div class="flex items-center gap-2 text-gray-400"><!> <span class="text-sm font-medium">Recent Commits</span></div></div> <div class="flex-1 overflow-y-auto"><!></div></div></div>');function ha(L,n){oe(n,!0);const b=He();let _=ee(ae(b?.statuses||n.data.statuses)),D=ee(ae(b?.lastUpdated||n.data.lastUpdated)),N=ee(ae(n.data.deploymentLog||[])),g=z(()=>[...e(_)].filter(r=>r.lastPush).sort((r,o)=>{const i=new Date(r.lastPush||0).getTime();return new Date(o.lastPush||0).getTime()-i}).slice(0,20));me(()=>{n.data.statuses&&n.data.statuses.length>0&&(R(_,n.data.statuses,!0),R(D,n.data.lastUpdated,!0),Ke(n.data.statuses,n.data.lastUpdated)),n.data.deploymentLog&&R(N,n.data.deploymentLog,!0)});const U="https://observatory-backend.fly.dev";let be=z(()=>n.data.apiSecret||"");me(()=>{te.connect(U,e(be));const r=te.subscribe(o=>{if(o.type==="deployment"&&o.project){const i=o.data;De(o.project,i)}});return()=>{r(),te.disconnect()}});function De(r,o){R(D,new Date().toISOString(),!0),R(_,e(_).map(i=>{if(i.repo===r||i.repo.toLowerCase()===r.toLowerCase()){let a;switch(o.status){case"success":a="success";break;case"failure":a="failure";break;case"in_progress":case"queued":a="deploying";break;default:a="unknown"}return{...i,deployStatus:a,deployedAt:new Date().toISOString(),deployUrl:o.runUrl||i.deployUrl,run_date:new Date().toISOString()}}return i}),!0)}function ne(r){if(!r)return"";const o=new Date(r),a=new Date().getTime()-o.getTime(),u=Math.floor(a/6e4),f=Math.floor(a/36e5),m=Math.floor(a/864e5);return u<1?"just now":u<60?`${u}m ago`:f<24?`${f}h ago`:m<7?`${m}d ago`:o.toLocaleDateString()}function ke(r){switch(r){case"success":return"text-green-400";case"failure":return"text-red-400";case"deploying":return"text-cyan-400";default:return"text-gray-400"}}function Ce(r){switch(r){case"success":return"Deployed";case"failure":return"Failed";case"deploying":return"Deploying";default:return"Unknown"}}var H=oa();Ge("1uha8ag",r=>{Ee(()=>{ze.title="Console | Orchon"})});var K=s(H),V=s(K),J=s(V),Se=s(J);re(Se,{class:"w-4 h-4"}),F(2),t(J);var le=c(J,2),Le=c(s(le));Xe(Le,{class:"w-3 h-3"}),t(le),t(V);var de=c(V,2),Ne=s(de);{var Ue=r=>{var o=Ye(),i=s(o);re(i,{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),F(2),t(o),v(r,o)},Pe=r=>{var o=$e();pe(o,21,()=>e(N),i=>i.id,(i,a)=>{const u=z(()=>e(a).deployCompletedAt||e(a).completedAt||e(a).startedAt),f=z(()=>e(a).status==="success"?"success":e(a).status==="failure"?"failure":e(a).status==="in_progress"?"deploying":"unknown");var m=Ze(),h=s(m),P=s(h);{var j=l=>{Ve(l,{class:"w-5 h-5 text-cyan-400 animate-spin"})},W=l=>{var d=q(),y=G(d);{var $=C=>{Qe(C,{class:"w-5 h-5 text-green-400"})},Te=C=>{var ue=q(),Ie=G(ue);{var Re=S=>{We(S,{class:"w-5 h-5 text-red-400"})},Be=S=>{re(S,{class:"w-5 h-5 text-gray-500"})};w(Ie,S=>{e(f)==="failure"?S(Re):S(Be,!1)},!0)}v(C,ue)};w(y,C=>{e(f)==="success"?C($):C(Te,!1)},!0)}v(l,d)};w(P,l=>{e(f)==="deploying"?l(j):l(W,!1)})}t(h);var A=c(h,2),M=s(A),k=s(M),X=s(k,!0);t(k);var O=c(k,2),Y=s(O,!0);t(O),t(M);var T=c(M,2),I=s(T);t(T),t(A);var E=c(A,2),Z=s(E,!0);t(E),t(m),B((l,d,y)=>{xe(m,"href",`/deployments?project=${e(a).projectName??""}`),p(X,e(a).projectDisplayName||e(a).projectName),qe(O,1,`text-xs ${l??""}`),p(Y,d),p(I,`${e(a).provider??""} ${e(a).branch?`â€¢ ${e(a).branch}`:""}`),p(Z,y)},[()=>ke(e(f)),()=>Ce(e(f)),()=>ne(e(u))]),v(i,m)}),t(o),v(r,o)};w(Ne,r=>{e(N).length===0?r(Ue):r(Pe,!1)})}t(de),t(K);var ce=c(K,2),Q=s(ce),ve=s(Q),je=s(ve);se(je,{class:"w-4 h-4"}),F(2),t(ve),t(Q);var fe=c(Q,2),Ae=s(fe);{var Me=r=>{var o=ea(),i=s(o);se(i,{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),F(2),t(o),v(r,o)},Oe=r=>{var o=sa();pe(o,21,()=>e(g),i=>i.repo+i.lastPush,(i,a)=>{var u=ra(),f=s(u),m=s(f);se(m,{class:"w-5 h-5 text-gray-400"}),t(f);var h=c(f,2),P=s(h),j=s(P),W=s(j,!0);t(j);var A=c(j,2);{var M=l=>{var d=aa(),y=s(d,!0);t(d),B(()=>p(y,e(a).version)),v(l,d)};w(A,l=>{e(a).version&&l(M)})}t(P);var k=c(P,2),X=s(k);{var O=l=>{var d=ta(),y=s(d,!0);t(d),B($=>p(y,$),[()=>e(a).lastCommitSha.slice(0,7)]),v(l,d)},Y=l=>{var d=Fe();B(()=>p(d,`Pushed to ${e(a).owner??""}/${e(a).repo??""}`)),v(l,d)};w(X,l=>{e(a).lastCommitSha?l(O):l(Y,!1)})}t(k),t(h);var T=c(h,2),I=s(T),E=s(I,!0);t(I);var Z=c(I,2);Je(Z,{class:"w-3 h-3"}),t(T),t(u),B(l=>{xe(u,"href",e(a).repoUrl),p(W,e(a).repo),p(E,l)},[()=>ne(e(a).lastPush)]),v(i,u)}),t(o),v(r,o)};w(Ae,r=>{e(g).length===0?r(Me):r(Oe,!1)})}t(fe),t(ce),t(H),v(L,H),ie()}export{ha as component};
