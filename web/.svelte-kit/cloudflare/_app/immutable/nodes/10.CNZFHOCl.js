import"../chunks/DsnmJJEf.js";import{C as Qt,P as Vt,a0 as Xt,H as Kt,p as Wt,s as Q,a as vt,u as ut,b as M,g as e,f as x,j as u,i,t as b,c as d,d as Yt,h as Zt,$ as te,r as o,e as q,k as V,l as X}from"../chunks/VB45bhtT.js";import{s as g}from"../chunks/CgppWemH.js";import{i as p}from"../chunks/CuIfUMuc.js";import{B as ee}from"../chunks/CNKuqfku.js";import{e as K,i as dt,s as ft}from"../chunks/oRfbssuc.js";import{h as re}from"../chunks/B2E4lz1E.js";import{i as ae,b as se,s as _t}from"../chunks/CyWyFm7g.js";import{d as oe}from"../chunks/D3xLfT3q.js";import{g as ie}from"../chunks/CruRBgby.js";import{F as ne}from"../chunks/DRzAw-l1.js";import{X as le}from"../chunks/DXTVCWaa.js";import{C as xt}from"../chunks/DeNegKwn.js";import{C as ce}from"../chunks/CbrDBhVw.js";import{L as ve,C as ue,a as de}from"../chunks/Cc5ivBPk.js";import{G as fe}from"../chunks/BvOfDT3N.js";import{E as _e}from"../chunks/DYc-kdkA.js";function xe(I,y,m){Qt&&Vt();var h=new ee(I),S=!Xt();Kt(()=>{var T=y();S&&T!==null&&typeof T=="object"&&(T={}),h.ensure(T,m)})}var me=x("<option> </option>"),ge=x('<button class="flex items-center gap-1 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-500 transition-colors"> <!></button>'),pe=x('<button class="px-2 py-0.5 text-xs bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded transition-colors"> </button>'),he=x('<div class="flex flex-wrap items-center gap-2"><span class="text-xs text-gray-500">Recent:</span> <!></div>'),be=x('<p class="text-sm mt-1">Try selecting a different project or clear the filter</p>'),we=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-lg">No deployments found</p> <!></div>'),ye=x('<span class="flex items-center gap-1"><!> </span>'),ke=x('<a target="_blank" rel="noopener noreferrer" class="font-mono text-xs hover:text-blue-400 transition-colors"> </a>'),De=x('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-1 hover:text-blue-400 transition-colors">View logs <!></a>'),Te=x("<div> </div>"),Ae=x('<div class="text-xs text-gray-600 mt-0.5"> </div>'),Se=x('<div class="px-4 py-4 hover:bg-gray-800/30 transition-colors"><div class="flex items-start gap-4"><div class="shrink-0 mt-0.5"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 flex-wrap"><button class="font-medium text-white hover:text-blue-400 transition-colors"> </button> <span> </span> <span class="text-xs text-gray-600 capitalize"> </span></div> <div class="flex items-center gap-4 mt-1.5 text-sm text-gray-500"><!> <!> <!></div></div> <div class="shrink-0 text-right"><div class="flex items-center gap-1.5 text-sm text-gray-400"><!> </div> <!></div></div></div>'),je=x('<div class="divide-y divide-gray-800"></div>'),Ce=x('<div class="flex-1 flex flex-col h-full overflow-hidden"><div class="shrink-0 px-4 py-4 border-b border-gray-800 bg-gray-900/50"><div class="flex flex-col gap-3"><div class="flex items-center justify-between"><h1 class="text-lg font-semibold text-white">Deployment Log</h1> <span class="text-sm text-gray-500"> </span></div> <div class="flex flex-wrap items-center gap-2"><!> <select class="bg-gray-800 border border-gray-700 rounded px-3 py-1.5 text-sm text-gray-300 focus:outline-none focus:border-blue-500"><option>All Projects</option><!></select> <!></div> <!></div></div> <div class="flex-1 overflow-y-auto"><!></div></div>');function Qe(I,y){Wt(y,!0);let m=Q(vt(y.data.projectFilter)),h=Q(vt([]));ut(()=>{{const t=localStorage.getItem("orchon-recent-project-filters");if(t)try{M(h,JSON.parse(t),!0)}catch{M(h,[],!0)}}});let S=q(()=>[...e(m)?y.data.deployments.filter(r=>r.projectName===e(m)):y.data.deployments].sort((r,a)=>{const s=r.status==="in_progress"||r.status==="queued",c=a.status==="in_progress"||a.status==="queued";if(s&&!c)return-1;if(!s&&c)return 1;const v=new Date(r.deployCompletedAt||r.completedAt||r.startedAt||0).getTime();return new Date(a.deployCompletedAt||a.completedAt||a.startedAt||0).getTime()-v}));function T(t){return y.data.projects.find(a=>a.id===t)?.name||t}function L(t){M(m,t,!0);{const r=new URL(window.location.href);t?r.searchParams.set("project",t):r.searchParams.delete("project"),ie(r.toString(),{replaceState:!0,noScroll:!0}),t&&!e(h).includes(t)&&(M(h,[t,...e(h).filter(a=>a!==t)].slice(0,5),!0),localStorage.setItem("orchon-recent-project-filters",JSON.stringify(e(h))))}}function mt(t){if(!t)return"Unknown";const r=new Date(t),s=new Date().getTime()-r.getTime(),c=Math.floor(s/6e4),v=Math.floor(s/36e5),f=Math.floor(s/864e5);return c<1?"just now":c<60?`${c}m ago`:v<24?`${v}h ago`:f<7?`${f}d ago`:r.toLocaleDateString()}function gt(t){return t?new Date(t).toLocaleString():""}function pt(t){switch(t){case"success":return"text-green-400";case"failure":return"text-red-400";case"in_progress":return"text-cyan-400";default:return"text-gray-400"}}function ht(t){switch(t){case"success":return"Success";case"failure":return"Failed";case"in_progress":return"Deploying";case"queued":return"Queued";default:return"Unknown"}}function W(t){const r=Math.floor(t/1e3),a=Math.floor(r/60),s=Math.floor(a/60);return s>0?`${s}h ${a%60}m`:a>0?`${a}m ${r%60}s`:`${r}s`}function bt(t){const r=t.status,a=t.ciStartedAt||t.startedAt,s=t.deployCompletedAt||t.completedAt;if(r==="in_progress"||r==="queued"){if(!a)return null;const c=new Date(a).getTime(),v=Date.now()-c;return{text:`running ${W(v)}`,color:"text-cyan-400"}}else if(r==="success"||r==="failure"){if(!a||!s)return null;const c=new Date(a).getTime(),f=new Date(s).getTime()-c;if(f<0)return null;const A=r==="failure"?"failed after":"took",P=r==="failure"?"text-red-400":"text-green-400";return{text:`${A} ${W(f)}`,color:P}}return null}let $=Q(0);ut(()=>{{const t=setInterval(()=>{M($,e($)+1)},1e4);return()=>clearInterval(t)}});var O=Ce();re("1tckhxz",t=>{Zt(()=>{te.title="Deployments | Orchon"})});var R=i(O),Y=i(R),z=i(Y),Z=u(i(z),2),wt=i(Z);o(Z),o(z);var B=u(z,2),tt=i(B);ne(tt,{class:"w-4 h-4 text-gray-500 shrink-0"});var k=u(tt,2);k.__change=t=>L(t.currentTarget.value||null);var E=i(k);E.value=E.__value="";var yt=u(E);K(yt,17,()=>y.data.projects,dt,(t,r)=>{var a=me(),s=i(a,!0);o(a);var c={};b(()=>{g(s,e(r).name),c!==(c=e(r).id)&&(a.value=(a.__value=e(r).id)??"")}),d(t,a)}),o(k);var et;ae(k);var kt=u(k,2);{var Dt=t=>{var r=ge();r.__click=()=>L(null);var a=i(r),s=u(a);le(s,{class:"w-3 h-3"}),o(r),b(c=>g(a,`${c??""} `),[()=>T(e(m))]),d(t,r)};p(kt,t=>{e(m)&&t(Dt)})}o(B);var Tt=u(B,2);{var At=t=>{var r=he(),a=u(i(r),2);K(a,17,()=>e(h),dt,(s,c)=>{var v=pe();v.__click=()=>L(e(c));var f=i(v,!0);o(v),b(A=>g(f,A),[()=>T(e(c))]),d(s,v)}),o(r),d(t,r)};p(Tt,t=>{e(h).length>0&&!e(m)&&t(At)})}o(Y),o(R);var rt=u(R,2),St=i(rt);{var jt=t=>{var r=we(),a=i(r);xt(a,{class:"w-12 h-12 mx-auto mb-3 opacity-50"});var s=u(a,4);{var c=v=>{var f=be();d(v,f)};p(s,v=>{e(m)&&v(c)})}o(r),d(t,r)},Ct=t=>{var r=je();K(r,21,()=>e(S),a=>a.id,(a,s)=>{const c=q(()=>e(s).deployCompletedAt||e(s).completedAt||e(s).startedAt),v=q(()=>e(s).status),f=q(()=>bt(e(s)));var A=Se(),P=i(A),G=i(P),Mt=i(G);{var Lt=n=>{ve(n,{class:"w-5 h-5 text-cyan-400 animate-spin"})},Pt=n=>{var l=V(),_=X(l);{var w=D=>{ue(D,{class:"w-5 h-5 text-green-400"})},j=D=>{var ct=V(),Ht=X(ct);{var Jt=C=>{de(C,{class:"w-5 h-5 text-red-400"})},Nt=C=>{xt(C,{class:"w-5 h-5 text-gray-500"})};p(Ht,C=>{e(v)==="failure"?C(Jt):C(Nt,!1)},!0)}d(D,ct)};p(_,D=>{e(v)==="success"?D(w):D(j,!1)},!0)}d(n,l)};p(Mt,n=>{e(v)==="in_progress"?n(Lt):n(Pt,!1)})}o(G);var H=u(G,2),J=i(H),F=i(J);F.__click=()=>L(e(s).projectName);var Ft=i(F,!0);o(F);var U=u(F,2),Ut=i(U,!0);o(U);var at=u(U,2),qt=i(at,!0);o(at),o(J);var st=u(J,2),ot=i(st);{var It=n=>{var l=ye(),_=i(l);fe(_,{class:"w-3.5 h-3.5"});var w=u(_);o(l),b(()=>g(w,` ${e(s).branch??""}`)),d(n,l)};p(ot,n=>{e(s).branch&&n(It)})}var it=u(ot,2);{var $t=n=>{var l=ke(),_=i(l,!0);o(l),b(w=>{_t(l,"href",`https://github.com/jaslr/${e(s).projectName??""}/commit/${e(s).commitSha??""}`),g(_,w)},[()=>e(s).commitSha.slice(0,7)]),d(n,l)};p(it,n=>{e(s).commitSha&&n($t)})}var Ot=u(it,2);{var Rt=n=>{var l=De(),_=u(i(l));_e(_,{class:"w-3 h-3"}),o(l),b(()=>_t(l,"href",e(s).runUrl)),d(n,l)};p(Ot,n=>{e(s).runUrl&&n(Rt)})}o(st),o(H);var nt=u(H,2),N=i(nt),lt=i(N);ce(lt,{class:"w-3.5 h-3.5"});var zt=u(lt);o(N);var Bt=u(N,2);{var Et=n=>{var l=V(),_=X(l);xe(_,()=>e($),w=>{var j=Te(),D=i(j,!0);o(j),b(()=>{ft(j,1,`text-xs font-medium mt-0.5 ${e(f).color??""}`),g(D,e(f).text)}),d(w,j)}),d(n,l)},Gt=n=>{var l=Ae(),_=i(l,!0);o(l),b(w=>g(_,w),[()=>gt(e(c))]),d(n,l)};p(Bt,n=>{e(f)?n(Et):n(Gt,!1)})}o(nt),o(P),o(A),b((n,l,_)=>{g(Ft,e(s).projectDisplayName||e(s).projectName),ft(U,1,`text-xs px-1.5 py-0.5 rounded ${n??""} bg-gray-800`),g(Ut,l),g(qt,e(s).provider),g(zt,` ${_??""}`)},[()=>pt(e(v)),()=>ht(e(v)),()=>mt(e(c))]),d(a,A)}),o(r),d(t,r)};p(St,t=>{e(S).length===0?t(jt):t(Ct,!1)})}o(rt),o(O),b(()=>{g(wt,`${e(S).length??""} deployment${e(S).length!==1?"s":""}`),et!==(et=e(m)||"")&&(k.value=(k.__value=e(m)||"")??"",se(k,e(m)||""))}),d(I,O),Yt()}oe(["change","click"]);export{Qe as component};
