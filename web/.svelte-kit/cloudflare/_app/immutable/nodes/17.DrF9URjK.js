import"../chunks/DsnmJJEf.js";import{p as ne,c as St,f as jt,o as Ee,a as $,h as ae,v as At,k as b,l as I,r as m,t as K,g as t,i as G,d as R,s as ut,b as qt,e as at,n as Gt,x as Je,u as Qt,j as Ve,$ as We}from"../chunks/Dnd2HTQh.js";import{s as dt}from"../chunks/BDR25Ma5.js";import{i as et}from"../chunks/DKZzDoih.js";import{e as Nt,i as Et,s as yt,a as ge}from"../chunks/C4TM4onk.js";import{c as we}from"../chunks/LdpL5_qW.js";import{h as Ke}from"../chunks/DoDuvpHD.js";import{I as ze,s as A}from"../chunks/H3ICmHr2.js";import{d as xe,e as Ht,j as Qe}from"../chunks/Dc2clUla.js";import{p as Ze}from"../chunks/UtpV3adH.js";import{a as qe,b as tr,A as be,T as ke,H as er,I as rr}from"../chunks/BdsGDAu5.js";import{o as nr,a as ar}from"../chunks/D5oE3Dzy.js";import{b as ir}from"../chunks/BxCSoznQ.js";import{R as Ne}from"../chunks/D_udCXUP.js";import{E as or}from"../chunks/BFTGOLv7.js";import{A as sr}from"../chunks/D0ZeerC-.js";import{C as lr}from"../chunks/B3I-nrw2.js";import{s as Re}from"../chunks/-9B-tiFA.js";import{s as Te,r as Oe}from"../chunks/CqyOSPLz.js";import{C as je}from"../chunks/BlC5L8fo.js";import{S as Pe,D as se}from"../chunks/C327RtVB.js";import{S as ve}from"../chunks/B_HwfPhO.js";import{C as cr,M as fr}from"../chunks/CsQnTzvn.js";import{G as Me}from"../chunks/Co9s49gQ.js";import{G as Se}from"../chunks/Dbpxzosl.js";import{C as Ft}from"../chunks/I1MDvhxE.js";function ur(e,r){ne(r,!0);let n=Oe(r,["$$slots","$$events","$$legacy"]);const a=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"}]];ze(e,Te({name:"layout-grid"},()=>n,{get iconNode(){return a},children:(i,s)=>{var u=St(),o=jt(u);Re(o,()=>r.children??Ee),$(i,u)},$$slots:{default:!0}})),ae()}function dr(e,r){ne(r,!0);let n=Oe(r,["$$slots","$$events","$$legacy"]);const a=[["path",{d:"M3 5h.01"}],["path",{d:"M3 12h.01"}],["path",{d:"M3 19h.01"}],["path",{d:"M8 5h13"}],["path",{d:"M8 12h13"}],["path",{d:"M8 19h13"}]];ze(e,Te({name:"list"},()=>n,{get iconNode(){return a},children:(i,s)=>{var u=St(),o=jt(u);Re(o,()=>r.children??Ee),$(i,u)},$$slots:{default:!0}})),ae()}var vr=At('<radialGradient cx="30%" cy="30%"><stop offset="0%" stop-opacity="0.9"></stop><stop offset="100%" stop-opacity="0.4"></stop></radialGradient>'),gr=At('<path fill="none" class="transition-all duration-150"></path>'),hr=At('<g class="cursor-pointer" role="listitem"><circle cx="0" cy="0" r="2" stroke-width="0.5" class="transition-all duration-150"></circle><text x="-6" y="1.5" text-anchor="end"> </text></g>'),pr=At('<circle cx="0" cy="0" fill="none" stroke-width="0.3" opacity="0.4"></circle>'),xr=At('<image preserveAspectRatio="xMidYMid meet"></image>'),yr=At('<text x="0" y="1.5" text-anchor="middle" class="text-[3px] fill-white font-bold"> </text>'),mr=At('<g><circle cx="0" cy="0" r="1.5" fill="#ef4444"></circle><text x="0" y="1" text-anchor="middle" class="text-[2px] fill-white font-bold">!</text></g>'),_r=At('<g class="cursor-pointer" role="button" tabindex="0"><circle cx="0" cy="0" class="transition-all duration-150"></circle><!><!><text y="-1" text-anchor="start"> </text><text y="3" text-anchor="start" class="text-[2.5px] font-medium"> </text><!></g>'),wr=At('<svg class="w-full h-full"><defs></defs><text y="18" text-anchor="middle" class="text-[3px] fill-gray-500 uppercase tracking-wider font-semibold">Projects</text><text y="18" text-anchor="middle" class="text-[3px] fill-gray-500 uppercase tracking-wider font-semibold">Providers</text><!><!><!><g><text x="0" y="0" class="text-[2.5px] fill-gray-500 uppercase tracking-wider">Vendor Risk</text><g transform="translate(0, 5)"><circle cx="2" cy="0" r="1.5" fill="#4b5563"></circle><text x="6" y="1" class="text-[2.5px] fill-gray-400">Low</text></g><g transform="translate(22, 5)"><circle cx="2.5" cy="0" r="2.5" fill="#6b7280"></circle><text x="7" y="1" class="text-[2.5px] fill-gray-400">Med</text></g><g transform="translate(45, 5)"><circle cx="3.5" cy="0" r="3.5" fill="#9ca3af"></circle><circle cx="0.5" cy="-2.5" r="1.5" fill="#ef4444"></circle><text x="0" y="-1.5" class="text-[2px] fill-white font-bold">!</text><text x="9" y="1" class="text-[2.5px] fill-gray-400">High (50%+)</text></g></g></svg>');function br(e,r){ne(r,!0);let n=G(()=>{const l=new Map;for(const f of r.projects)l.set(f.id,new Set);for(const f of r.categories)for(const N of f.providers)for(const C of N.projects)l.get(C.id)?.add(N.provider);return l}),a=G(()=>{const l=new Map;for(const f of r.categories)for(const N of f.providers){const C=l.get(N.provider);if(C){C.categories.includes(f.category)||C.categories.push(f.category);for(const L of N.projects)C.projectIds.has(L.id)||(C.projectIds.add(L.id),C.projects.push(L));C.inDegree=C.projects.length}else l.set(N.provider,{provider:N.provider,categories:[f.category],inDegree:N.projects.length,projectIds:new Set(N.projects.map(L=>L.id)),projects:[...N.projects]})}return Array.from(l.values()).sort((f,N)=>N.inDegree-f.inDegree)}),i=G(()=>Math.max(...t(a).map(l=>l.inDegree),1));const u=20+100,o=450,v=40,c=22,w=38,M=2,_=5,h={hosting:"#f97316",database:"#22c55e",auth:"#eab308",storage:"#ec4899",ci:"#6b7280",monitoring:"#ef4444",dns:"#06b6d4",email:"#8b5cf6",analytics:"#3b82f6",cdn:"#14b8a6",secrets:"#a855f7"},S={cloudflare:"Cloudflare",flyio:"Fly.io",supabase:"Supabase",github:"GitHub",sentry:"Sentry",aws:"AWS",vercel:"Vercel",netlify:"Netlify",google:"Google",gcp:"GCP"};let g=G(()=>{const l=new Map;let f=v;for(const N of r.projects)l.set(N.id,{x:u,y:f}),f+=c;return l}),d=G(()=>{const l=new Map;let f=v;for(const N of t(a))l.set(N.provider,{x:o,y:f,categories:N.categories,inDegree:N.inDegree}),f+=w;return l});function x(l){const f=l/t(i);return M+(_-M)*f}function k(l){return .4+.6*(l/t(i))}let z=G(()=>{const l=r.projects.length*c+v+50,f=t(a).length*w+v+50;return Math.max(l,f,300)});function P(l){return S[l]||l}function B(l){return h[l]||"#6b7280"}function lt(l){return["cloudflare","flyio","supabase","github","sentry","vercel","netlify"].includes(l)?`/api/logos/infra/${l}.svg`:null}let U=ut(null),O=ut(null);function gt(l,f){return!!(r.selectedProvider===f||t(O)===f||t(U)===l&&(t(n).get(l)?.has(f)??!1))}function rt(l,f){return!r.selectedProvider&&!t(U)&&!t(O)?!1:r.selectedProvider?f!==r.selectedProvider:t(O)?f!==t(O):t(U)?!(t(n).get(t(U))?.has(f)??!1):!1}function ht(l){return!!(t(U)===l||t(O)&&(t(n).get(l)?.has(t(O))??!1)||r.selectedProvider&&(t(n).get(l)?.has(r.selectedProvider)??!1))}function pt(l){return!!(r.selectedProvider&&!(t(n).get(l)?.has(r.selectedProvider)??!1)||t(O)&&!(t(n).get(l)?.has(t(O))??!1))}function xt(l){return!!(t(O)===l||r.selectedProvider===l||t(U)&&(t(n).get(t(U))?.has(l)??!1))}function Ct(l){return!!(r.selectedProvider&&r.selectedProvider!==l||t(O)&&t(O)!==l||t(U)&&!(t(n).get(t(U))?.has(l)??!1))}function It(l,f){const N=t(g).get(l),C=t(d).get(f);if(!N||!C)return"";const L=N.x+3,F=N.y,tt=C.x-x(C.inDegree)-1,W=C.y,ot=(L+tt)/2;return`M ${L} ${F} C ${ot} ${F}, ${ot} ${W}, ${tt} ${W}`}function Dt(l){return l[0]||"hosting"}var Pt=wr(),zt=b(Pt);Nt(zt,21,()=>t(a),Et,(l,f)=>{const N=G(()=>B(Dt(t(f).categories)));var C=vr(),L=b(C),F=I(L);m(C),K(()=>{A(C,"id",`grad-${t(f).provider??""}`),A(L,"stop-color",t(N)),A(F,"stop-color",t(N))}),$(l,C)}),m(zt);var Lt=I(zt);A(Lt,"x",u);var Xt=I(Lt);A(Xt,"x",o);var Rt=I(Xt);Nt(Rt,17,()=>r.projects,Et,(l,f)=>{const N=G(()=>t(n).get(t(f).id));var C=St(),L=jt(C);{var F=tt=>{var W=St(),ot=jt(W);Nt(ot,17,()=>[...t(N)],Et,(p,y)=>{const j=G(()=>t(d).get(t(y))),D=G(()=>gt(t(f).id,t(y))),T=G(()=>rt(t(f).id,t(y)));var X=St(),H=jt(X);{var J=Z=>{var E=gr();K((Q,vt)=>{A(E,"d",Q),A(E,"stroke",vt),A(E,"stroke-width",t(D)?.5:.25),A(E,"opacity",t(T)?.08:t(D)?.9:.25)},[()=>It(t(f).id,t(y)),()=>t(D)?B(Dt(t(j).categories)):"#374151"]),$(Z,E)};et(H,Z=>{t(j)&&Z(J)})}$(p,X)}),$(tt,W)};et(L,tt=>{t(N)&&tt(F)})}$(l,C)});var $t=I(Rt);Nt($t,17,()=>r.projects,Et,(l,f)=>{const N=G(()=>t(g).get(t(f).id)),C=G(()=>ht(t(f).id)),L=G(()=>pt(t(f).id));var F=St(),tt=jt(F);{var W=ot=>{var p=hr(),y=b(p),j=I(y),D=b(j,!0);m(j),m(p),K(T=>{A(p,"transform",`translate(${t(N).x??""}, ${t(N).y??""})`),A(p,"opacity",t(L)?.15:1),A(y,"fill",t(C)?"#3b82f6":"#4b5563"),A(y,"stroke",t(C)?"#60a5fa":"transparent"),yt(j,0,`text-[3px] ${t(C)?"fill-white font-medium":"fill-gray-400"} transition-colors`),dt(D,T)},[()=>t(f).displayName.length>18?t(f).displayName.slice(0,17)+"..":t(f).displayName]),Ht("mouseenter",p,()=>R(U,t(f).id,!0)),Ht("mouseleave",p,()=>R(U,null)),$(ot,p)};et(tt,ot=>{t(N)&&ot(W)})}$(l,F)});var Ut=I($t);Nt(Ut,17,()=>t(a),Et,(l,f)=>{const N=G(()=>t(d).get(t(f).provider)),C=G(()=>xt(t(f).provider)),L=G(()=>Ct(t(f).provider)),F=G(()=>x(t(f).inDegree)),tt=G(()=>k(t(f).inDegree)),W=G(()=>lt(t(f).provider));var ot=St(),p=jt(ot);{var y=j=>{var D=_r();D.__click=()=>r.onProviderClick(t(f).provider),D.__keydown=Y=>Y.key==="Enter"&&r.onProviderClick(t(f).provider);var T=b(D),X=I(T);{var H=Y=>{var V=pr();K(it=>{A(V,"r",t(F)-1),A(V,"stroke",it)},[()=>B(Dt(t(f).categories))]),$(Y,V)};et(X,Y=>{t(f).inDegree>t(i)*.5&&Y(H)})}var J=I(X);{var Z=Y=>{var V=xr();K(()=>{A(V,"x",-t(F)*.55),A(V,"y",-t(F)*.55),A(V,"width",t(F)*1.1),A(V,"height",t(F)*1.1),A(V,"href",t(W))}),$(Y,V)},E=Y=>{var V=yr(),it=b(V,!0);m(V),K(Mt=>dt(it,Mt),[()=>t(f).provider.charAt(0).toUpperCase()]),$(Y,V)};et(J,Y=>{t(W)?Y(Z):Y(E,!1)})}var Q=I(J),vt=b(Q,!0);m(Q);var ct=I(Q),ft=b(ct);m(ct);var q=I(ct);{var bt=Y=>{var V=mr();K(()=>A(V,"transform",`translate(${-t(F)-2}, ${-t(F)+1})`)),$(Y,V)};et(q,Y=>{t(f).inDegree>=Math.ceil(r.projects.length*.5)&&Y(bt)})}m(D),K((Y,V,it)=>{A(D,"transform",`translate(${t(N).x??""}, ${t(N).y??""})`),A(D,"opacity",t(L)?.15:1),A(T,"r",t(F)),A(T,"fill",`url(#grad-${t(f).provider??""})`),A(T,"stroke",Y),A(T,"stroke-width",t(C)?.75:.5),A(T,"opacity",t(tt)),A(Q,"x",t(F)+3),yt(Q,0,`text-[3px] ${t(C)?"fill-white font-medium":"fill-gray-300"} transition-colors`),dt(vt,V),A(ct,"x",t(F)+3),A(ct,"fill",it),dt(ft,`${t(f).inDegree??""} ${t(f).inDegree===1?"project":"projects"}`)},[()=>t(C)?B(Dt(t(f).categories)):"#374151",()=>P(t(f).provider),()=>B(Dt(t(f).categories))]),Ht("mouseenter",D,()=>R(O,t(f).provider,!0)),Ht("mouseleave",D,()=>R(O,null)),$(j,D)};et(p,j=>{t(N)&&j(y)})}$(l,ot)});var Vt=I(Ut);m(Pt),K(l=>{A(Pt,"viewBox",`0 0 600 ${t(z)??""}`),ge(Pt,`min-height: ${l??""}px;`),A(Vt,"transform",`translate(20, ${t(z)-15})`)},[()=>Math.min(t(z),450)]),$(e,Pt),ae()}xe(["click","keydown"]);function kr(e,r){var n,a=1;e==null&&(e=0),r==null&&(r=0);function i(){var s,u=n.length,o,v=0,c=0;for(s=0;s<u;++s)o=n[s],v+=o.x,c+=o.y;for(v=(v/u-e)*a,c=(c/u-r)*a,s=0;s<u;++s)o=n[s],o.x-=v,o.y-=c}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(e=+s,i):e},i.y=function(s){return arguments.length?(r=+s,i):r},i.strength=function(s){return arguments.length?(a=+s,i):a},i}function Nr(e){const r=+this._x.call(null,e),n=+this._y.call(null,e);return Le(this.cover(r,n),r,n,e)}function Le(e,r,n,a){if(isNaN(r)||isNaN(n))return e;var i,s=e._root,u={data:a},o=e._x0,v=e._y0,c=e._x1,w=e._y1,M,_,h,S,g,d,x,k;if(!s)return e._root=u,e;for(;s.length;)if((g=r>=(M=(o+c)/2))?o=M:c=M,(d=n>=(_=(v+w)/2))?v=_:w=_,i=s,!(s=s[x=d<<1|g]))return i[x]=u,e;if(h=+e._x.call(null,s.data),S=+e._y.call(null,s.data),r===h&&n===S)return u.next=s,i?i[x]=u:e._root=u,e;do i=i?i[x]=new Array(4):e._root=new Array(4),(g=r>=(M=(o+c)/2))?o=M:c=M,(d=n>=(_=(v+w)/2))?v=_:w=_;while((x=d<<1|g)===(k=(S>=_)<<1|h>=M));return i[k]=s,i[x]=u,e}function jr(e){var r,n,a=e.length,i,s,u=new Array(a),o=new Array(a),v=1/0,c=1/0,w=-1/0,M=-1/0;for(n=0;n<a;++n)isNaN(i=+this._x.call(null,r=e[n]))||isNaN(s=+this._y.call(null,r))||(u[n]=i,o[n]=s,i<v&&(v=i),i>w&&(w=i),s<c&&(c=s),s>M&&(M=s));if(v>w||c>M)return this;for(this.cover(v,c).cover(w,M),n=0;n<a;++n)Le(this,u[n],o[n],e[n]);return this}function Pr(e,r){if(isNaN(e=+e)||isNaN(r=+r))return this;var n=this._x0,a=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,s=(a=Math.floor(r))+1;else{for(var u=i-n||1,o=this._root,v,c;n>e||e>=i||a>r||r>=s;)switch(c=(r<a)<<1|e<n,v=new Array(4),v[c]=o,o=v,u*=2,c){case 0:i=n+u,s=a+u;break;case 1:n=i-u,s=a+u;break;case 2:i=n+u,a=s-u;break;case 3:n=i-u,a=s-u;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=a,this._x1=i,this._y1=s,this}function Mr(){var e=[];return this.visit(function(r){if(!r.length)do e.push(r.data);while(r=r.next)}),e}function Sr(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function mt(e,r,n,a,i){this.node=e,this.x0=r,this.y0=n,this.x1=a,this.y1=i}function Ar(e,r,n){var a,i=this._x0,s=this._y0,u,o,v,c,w=this._x1,M=this._y1,_=[],h=this._root,S,g;for(h&&_.push(new mt(h,i,s,w,M)),n==null?n=1/0:(i=e-n,s=r-n,w=e+n,M=r+n,n*=n);S=_.pop();)if(!(!(h=S.node)||(u=S.x0)>w||(o=S.y0)>M||(v=S.x1)<i||(c=S.y1)<s))if(h.length){var d=(u+v)/2,x=(o+c)/2;_.push(new mt(h[3],d,x,v,c),new mt(h[2],u,x,d,c),new mt(h[1],d,o,v,x),new mt(h[0],u,o,d,x)),(g=(r>=x)<<1|e>=d)&&(S=_[_.length-1],_[_.length-1]=_[_.length-1-g],_[_.length-1-g]=S)}else{var k=e-+this._x.call(null,h.data),z=r-+this._y.call(null,h.data),P=k*k+z*z;if(P<n){var B=Math.sqrt(n=P);i=e-B,s=r-B,w=e+B,M=r+B,a=h.data}}return a}function Ir(e){if(isNaN(w=+this._x.call(null,e))||isNaN(M=+this._y.call(null,e)))return this;var r,n=this._root,a,i,s,u=this._x0,o=this._y0,v=this._x1,c=this._y1,w,M,_,h,S,g,d,x;if(!n)return this;if(n.length)for(;;){if((S=w>=(_=(u+v)/2))?u=_:v=_,(g=M>=(h=(o+c)/2))?o=h:c=h,r=n,!(n=n[d=g<<1|S]))return this;if(!n.length)break;(r[d+1&3]||r[d+2&3]||r[d+3&3])&&(a=r,x=d)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):r?(s?r[d]=s:delete r[d],(n=r[0]||r[1]||r[2]||r[3])&&n===(r[3]||r[2]||r[1]||r[0])&&!n.length&&(a?a[x]=n:this._root=n),this):(this._root=s,this)}function Dr(e){for(var r=0,n=e.length;r<n;++r)this.remove(e[r]);return this}function $r(){return this._root}function Cr(){var e=0;return this.visit(function(r){if(!r.length)do++e;while(r=r.next)}),e}function Er(e){var r=[],n,a=this._root,i,s,u,o,v;for(a&&r.push(new mt(a,this._x0,this._y0,this._x1,this._y1));n=r.pop();)if(!e(a=n.node,s=n.x0,u=n.y0,o=n.x1,v=n.y1)&&a.length){var c=(s+o)/2,w=(u+v)/2;(i=a[3])&&r.push(new mt(i,c,w,o,v)),(i=a[2])&&r.push(new mt(i,s,w,c,v)),(i=a[1])&&r.push(new mt(i,c,u,o,w)),(i=a[0])&&r.push(new mt(i,s,u,c,w))}return this}function zr(e){var r=[],n=[],a;for(this._root&&r.push(new mt(this._root,this._x0,this._y0,this._x1,this._y1));a=r.pop();){var i=a.node;if(i.length){var s,u=a.x0,o=a.y0,v=a.x1,c=a.y1,w=(u+v)/2,M=(o+c)/2;(s=i[0])&&r.push(new mt(s,u,o,w,M)),(s=i[1])&&r.push(new mt(s,w,o,v,M)),(s=i[2])&&r.push(new mt(s,u,M,w,c)),(s=i[3])&&r.push(new mt(s,w,M,v,c))}n.push(a)}for(;a=n.pop();)e(a.node,a.x0,a.y0,a.x1,a.y1);return this}function Rr(e){return e[0]}function Tr(e){return arguments.length?(this._x=e,this):this._x}function Or(e){return e[1]}function Lr(e){return arguments.length?(this._y=e,this):this._y}function ye(e,r,n){var a=new me(r??Rr,n??Or,NaN,NaN,NaN,NaN);return e==null?a:a.addAll(e)}function me(e,r,n,a,i,s){this._x=e,this._y=r,this._x0=n,this._y0=a,this._x1=i,this._y1=s,this._root=void 0}function Ae(e){for(var r={data:e.data},n=r;e=e.next;)n=n.next={data:e.data};return r}var wt=ye.prototype=me.prototype;wt.copy=function(){var e=new me(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root,n,a;if(!r)return e;if(!r.length)return e._root=Ae(r),e;for(n=[{source:r,target:e._root=new Array(4)}];r=n.pop();)for(var i=0;i<4;++i)(a=r.source[i])&&(a.length?n.push({source:a,target:r.target[i]=new Array(4)}):r.target[i]=Ae(a));return e};wt.add=Nr;wt.addAll=jr;wt.cover=Pr;wt.data=Mr;wt.extent=Sr;wt.find=Ar;wt.remove=Ir;wt.removeAll=Dr;wt.root=$r;wt.size=Cr;wt.visit=Er;wt.visitAfter=zr;wt.x=Tr;wt.y=Lr;function _t(e){return function(){return e}}function Ot(e){return(e()-.5)*1e-6}function Fr(e){return e.x+e.vx}function Gr(e){return e.y+e.vy}function Hr(e){var r,n,a,i=1,s=1;typeof e!="function"&&(e=_t(e==null?1:+e));function u(){for(var c,w=r.length,M,_,h,S,g,d,x=0;x<s;++x)for(M=ye(r,Fr,Gr).visitAfter(o),c=0;c<w;++c)_=r[c],g=n[_.index],d=g*g,h=_.x+_.vx,S=_.y+_.vy,M.visit(k);function k(z,P,B,lt,U){var O=z.data,gt=z.r,rt=g+gt;if(O){if(O.index>_.index){var ht=h-O.x-O.vx,pt=S-O.y-O.vy,xt=ht*ht+pt*pt;xt<rt*rt&&(ht===0&&(ht=Ot(a),xt+=ht*ht),pt===0&&(pt=Ot(a),xt+=pt*pt),xt=(rt-(xt=Math.sqrt(xt)))/xt*i,_.vx+=(ht*=xt)*(rt=(gt*=gt)/(d+gt)),_.vy+=(pt*=xt)*rt,O.vx-=ht*(rt=1-rt),O.vy-=pt*rt)}return}return P>h+rt||lt<h-rt||B>S+rt||U<S-rt}}function o(c){if(c.data)return c.r=n[c.data.index];for(var w=c.r=0;w<4;++w)c[w]&&c[w].r>c.r&&(c.r=c[w].r)}function v(){if(r){var c,w=r.length,M;for(n=new Array(w),c=0;c<w;++c)M=r[c],n[M.index]=+e(M,c,r)}}return u.initialize=function(c,w){r=c,a=w,v()},u.iterations=function(c){return arguments.length?(s=+c,u):s},u.strength=function(c){return arguments.length?(i=+c,u):i},u.radius=function(c){return arguments.length?(e=typeof c=="function"?c:_t(+c),v(),u):e},u}function Br(e){return e.index}function Ie(e,r){var n=e.get(r);if(!n)throw new Error("node not found: "+r);return n}function Xr(e){var r=Br,n=M,a,i=_t(30),s,u,o,v,c,w=1;e==null&&(e=[]);function M(d){return 1/Math.min(o[d.source.index],o[d.target.index])}function _(d){for(var x=0,k=e.length;x<w;++x)for(var z=0,P,B,lt,U,O,gt,rt;z<k;++z)P=e[z],B=P.source,lt=P.target,U=lt.x+lt.vx-B.x-B.vx||Ot(c),O=lt.y+lt.vy-B.y-B.vy||Ot(c),gt=Math.sqrt(U*U+O*O),gt=(gt-s[z])/gt*d*a[z],U*=gt,O*=gt,lt.vx-=U*(rt=v[z]),lt.vy-=O*rt,B.vx+=U*(rt=1-rt),B.vy+=O*rt}function h(){if(u){var d,x=u.length,k=e.length,z=new Map(u.map((B,lt)=>[r(B,lt,u),B])),P;for(d=0,o=new Array(x);d<k;++d)P=e[d],P.index=d,typeof P.source!="object"&&(P.source=Ie(z,P.source)),typeof P.target!="object"&&(P.target=Ie(z,P.target)),o[P.source.index]=(o[P.source.index]||0)+1,o[P.target.index]=(o[P.target.index]||0)+1;for(d=0,v=new Array(k);d<k;++d)P=e[d],v[d]=o[P.source.index]/(o[P.source.index]+o[P.target.index]);a=new Array(k),S(),s=new Array(k),g()}}function S(){if(u)for(var d=0,x=e.length;d<x;++d)a[d]=+n(e[d],d,e)}function g(){if(u)for(var d=0,x=e.length;d<x;++d)s[d]=+i(e[d],d,e)}return _.initialize=function(d,x){u=d,c=x,h()},_.links=function(d){return arguments.length?(e=d,h(),_):e},_.id=function(d){return arguments.length?(r=d,_):r},_.iterations=function(d){return arguments.length?(w=+d,_):w},_.strength=function(d){return arguments.length?(n=typeof d=="function"?d:_t(+d),S(),_):n},_.distance=function(d){return arguments.length?(i=typeof d=="function"?d:_t(+d),g(),_):i},_}var Ur={value:()=>{}};function Fe(){for(var e=0,r=arguments.length,n={},a;e<r;++e){if(!(a=arguments[e]+"")||a in n||/[\s.]/.test(a))throw new Error("illegal type: "+a);n[a]=[]}return new le(n)}function le(e){this._=e}function Yr(e,r){return e.trim().split(/^|\s+/).map(function(n){var a="",i=n.indexOf(".");if(i>=0&&(a=n.slice(i+1),n=n.slice(0,i)),n&&!r.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:a}})}le.prototype=Fe.prototype={constructor:le,on:function(e,r){var n=this._,a=Yr(e+"",n),i,s=-1,u=a.length;if(arguments.length<2){for(;++s<u;)if((i=(e=a[s]).type)&&(i=Jr(n[i],e.name)))return i;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++s<u;)if(i=(e=a[s]).type)n[i]=De(n[i],e.name,r);else if(r==null)for(i in n)n[i]=De(n[i],e.name,null);return this},copy:function(){var e={},r=this._;for(var n in r)e[n]=r[n].slice();return new le(e)},call:function(e,r){if((i=arguments.length-2)>0)for(var n=new Array(i),a=0,i,s;a<i;++a)n[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],a=0,i=s.length;a<i;++a)s[a].value.apply(r,n)},apply:function(e,r,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],i=0,s=a.length;i<s;++i)a[i].value.apply(r,n)}};function Jr(e,r){for(var n=0,a=e.length,i;n<a;++n)if((i=e[n]).name===r)return i.value}function De(e,r,n){for(var a=0,i=e.length;a<i;++a)if(e[a].name===r){e[a]=Ur,e=e.slice(0,a).concat(e.slice(a+1));break}return n!=null&&e.push({name:r,value:n}),e}var Jt=0,te=0,Zt=0,Ge=1e3,ce,ee,fe=0,Bt=0,ue=0,re=typeof performance=="object"&&performance.now?performance:Date,He=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Be(){return Bt||(He(Vr),Bt=re.now()+ue)}function Vr(){Bt=0}function he(){this._call=this._time=this._next=null}he.prototype=Xe.prototype={constructor:he,restart:function(e,r,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Be():+n)+(r==null?0:+r),!this._next&&ee!==this&&(ee?ee._next=this:ce=this,ee=this),this._call=e,this._time=n,pe()},stop:function(){this._call&&(this._call=null,this._time=1/0,pe())}};function Xe(e,r,n){var a=new he;return a.restart(e,r,n),a}function Wr(){Be(),++Jt;for(var e=ce,r;e;)(r=Bt-e._time)>=0&&e._call.call(void 0,r),e=e._next;--Jt}function $e(){Bt=(fe=re.now())+ue,Jt=te=0;try{Wr()}finally{Jt=0,Qr(),Bt=0}}function Kr(){var e=re.now(),r=e-fe;r>Ge&&(ue-=r,fe=e)}function Qr(){for(var e,r=ce,n,a=1/0;r;)r._call?(a>r._time&&(a=r._time),e=r,r=r._next):(n=r._next,r._next=null,r=e?e._next=n:ce=n);ee=e,pe(a)}function pe(e){if(!Jt){te&&(te=clearTimeout(te));var r=e-Bt;r>24?(e<1/0&&(te=setTimeout($e,e-re.now()-ue)),Zt&&(Zt=clearInterval(Zt))):(Zt||(fe=re.now(),Zt=setInterval(Kr,Ge)),Jt=1,He($e))}}const Zr=1664525,qr=1013904223,Ce=4294967296;function tn(){let e=1;return()=>(e=(Zr*e+qr)%Ce)/Ce}function en(e){return e.x}function rn(e){return e.y}var nn=10,an=Math.PI*(3-Math.sqrt(5));function on(e){var r,n=1,a=.001,i=1-Math.pow(a,1/300),s=0,u=.6,o=new Map,v=Xe(M),c=Fe("tick","end"),w=tn();e==null&&(e=[]);function M(){_(),c.call("tick",r),n<a&&(v.stop(),c.call("end",r))}function _(g){var d,x=e.length,k;g===void 0&&(g=1);for(var z=0;z<g;++z)for(n+=(s-n)*i,o.forEach(function(P){P(n)}),d=0;d<x;++d)k=e[d],k.fx==null?k.x+=k.vx*=u:(k.x=k.fx,k.vx=0),k.fy==null?k.y+=k.vy*=u:(k.y=k.fy,k.vy=0);return r}function h(){for(var g=0,d=e.length,x;g<d;++g){if(x=e[g],x.index=g,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var k=nn*Math.sqrt(.5+g),z=g*an;x.x=k*Math.cos(z),x.y=k*Math.sin(z)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function S(g){return g.initialize&&g.initialize(e,w),g}return h(),r={tick:_,restart:function(){return v.restart(M),r},stop:function(){return v.stop(),r},nodes:function(g){return arguments.length?(e=g,h(),o.forEach(S),r):e},alpha:function(g){return arguments.length?(n=+g,r):n},alphaMin:function(g){return arguments.length?(a=+g,r):a},alphaDecay:function(g){return arguments.length?(i=+g,r):+i},alphaTarget:function(g){return arguments.length?(s=+g,r):s},velocityDecay:function(g){return arguments.length?(u=1-g,r):1-u},randomSource:function(g){return arguments.length?(w=g,o.forEach(S),r):w},force:function(g,d){return arguments.length>1?(d==null?o.delete(g):o.set(g,S(d)),r):o.get(g)},find:function(g,d,x){var k=0,z=e.length,P,B,lt,U,O;for(x==null?x=1/0:x*=x,k=0;k<z;++k)U=e[k],P=g-U.x,B=d-U.y,lt=P*P+B*B,lt<x&&(O=U,x=lt);return O},on:function(g,d){return arguments.length>1?(c.on(g,d),r):c.on(g)}}}function sn(){var e,r,n,a,i=_t(-30),s,u=1,o=1/0,v=.81;function c(h){var S,g=e.length,d=ye(e,en,rn).visitAfter(M);for(a=h,S=0;S<g;++S)r=e[S],d.visit(_)}function w(){if(e){var h,S=e.length,g;for(s=new Array(S),h=0;h<S;++h)g=e[h],s[g.index]=+i(g,h,e)}}function M(h){var S=0,g,d,x=0,k,z,P;if(h.length){for(k=z=P=0;P<4;++P)(g=h[P])&&(d=Math.abs(g.value))&&(S+=g.value,x+=d,k+=d*g.x,z+=d*g.y);h.x=k/x,h.y=z/x}else{g=h,g.x=g.data.x,g.y=g.data.y;do S+=s[g.data.index];while(g=g.next)}h.value=S}function _(h,S,g,d){if(!h.value)return!0;var x=h.x-r.x,k=h.y-r.y,z=d-S,P=x*x+k*k;if(z*z/v<P)return P<o&&(x===0&&(x=Ot(n),P+=x*x),k===0&&(k=Ot(n),P+=k*k),P<u&&(P=Math.sqrt(u*P)),r.vx+=x*h.value*a/P,r.vy+=k*h.value*a/P),!0;if(h.length||P>=o)return;(h.data!==r||h.next)&&(x===0&&(x=Ot(n),P+=x*x),k===0&&(k=Ot(n),P+=k*k),P<u&&(P=Math.sqrt(u*P)));do h.data!==r&&(z=s[h.data.index]*a/P,r.vx+=x*z,r.vy+=k*z);while(h=h.next)}return c.initialize=function(h,S){e=h,n=S,w()},c.strength=function(h){return arguments.length?(i=typeof h=="function"?h:_t(+h),w(),c):i},c.distanceMin=function(h){return arguments.length?(u=h*h,c):Math.sqrt(u)},c.distanceMax=function(h){return arguments.length?(o=h*h,c):Math.sqrt(o)},c.theta=function(h){return arguments.length?(v=h*h,c):Math.sqrt(v)},c}function ln(e){var r=_t(.1),n,a,i;typeof e!="function"&&(e=_t(e==null?0:+e));function s(o){for(var v=0,c=n.length,w;v<c;++v)w=n[v],w.vx+=(i[v]-w.x)*a[v]*o}function u(){if(n){var o,v=n.length;for(a=new Array(v),i=new Array(v),o=0;o<v;++o)a[o]=isNaN(i[o]=+e(n[o],o,n))?0:+r(n[o],o,n)}}return s.initialize=function(o){n=o,u()},s.strength=function(o){return arguments.length?(r=typeof o=="function"?o:_t(+o),u(),s):r},s.x=function(o){return arguments.length?(e=typeof o=="function"?o:_t(+o),u(),s):e},s}function cn(e){var r=_t(.1),n,a,i;typeof e!="function"&&(e=_t(e==null?0:+e));function s(o){for(var v=0,c=n.length,w;v<c;++v)w=n[v],w.vy+=(i[v]-w.y)*a[v]*o}function u(){if(n){var o,v=n.length;for(a=new Array(v),i=new Array(v),o=0;o<v;++o)a[o]=isNaN(i[o]=+e(n[o],o,n))?0:+r(n[o],o,n)}}return s.initialize=function(o){n=o,u()},s.strength=function(o){return arguments.length?(r=typeof o=="function"?o:_t(+o),u(),s):r},s.y=function(o){return arguments.length?(e=typeof o=="function"?o:_t(+o),u(),s):e},s}var fn=at('<div class="absolute inset-0 flex items-center justify-center bg-gray-900/80 z-10"><div class="flex items-center gap-2 text-gray-400"><!> <span>Loading infrastructure status...</span></div></div>'),un=at('<div class="absolute top-4 left-4 right-4 bg-red-900/50 border border-red-700 rounded px-3 py-2 text-sm text-red-300 z-10"> </div>'),dn=at('<span class="text-xs text-gray-500"> </span>'),vn=At('<path fill="none" stroke="#374151" stroke-width="1.5" stroke-opacity="0.5" marker-end="url(#arrowhead)"></path>'),gn=At('<circle opacity="0.15"></circle>'),hn=At('<g class="cursor-pointer" role="button" tabindex="0"><!><circle class="transition-all duration-150"></circle><circle r="5"></circle><text text-anchor="middle" class="text-[11px] fill-gray-300 font-medium pointer-events-none"> </text><text text-anchor="middle" class="text-[9px] fill-gray-500 uppercase pointer-events-none"> </text></g>'),pn=at('<div class="flex justify-between"><span class="text-gray-400">Parent</span> <span class="text-gray-200"> </span></div>'),xn=at('<div class="flex justify-between"><span class="text-gray-400"> </span> <span class="text-gray-200"> </span></div>'),yn=at('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-1 text-blue-400 hover:text-blue-300 mt-3"><!> Open</a>'),mn=at('<div class="absolute bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-20"><div class="p-4"><div class="flex items-center justify-between mb-3"><h3 class="font-medium text-white"> </h3> <button class="text-gray-400 hover:text-gray-200 cursor-pointer">&times;</button></div> <div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-gray-400">Status</span> <span class="px-2 py-0.5 rounded text-xs font-medium"> </span></div> <div class="flex justify-between"><span class="text-gray-400">Type</span> <span class="text-gray-200 capitalize"> </span></div> <!> <!> <!></div></div></div>'),_n=at('<div class="flex items-center gap-1.5"><div class="w-3 h-3 rounded-full"></div> <span class="text-gray-400 capitalize"> </span></div>'),wn=at('<div class="relative w-full h-full min-h-[400px] bg-gray-900 rounded-lg overflow-hidden"><!> <!> <div class="absolute top-4 right-4 flex items-center gap-2 z-10"><button class="flex items-center gap-1.5 px-3 py-1.5 bg-gray-800 hover:bg-gray-700 rounded text-xs text-gray-300 transition-colors disabled:opacity-50 cursor-pointer"><!> Refresh</button> <!></div> <svg role="img" aria-label="Infrastructure map visualization"><g><!><!></g><defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#374151"></polygon></marker></defs></svg> <!> <div><div class="flex items-center gap-4"></div></div></div>');function bn(e,r){ne(r,!0);let n=ut(qt([])),a=ut(qt([])),i=ut(""),s=ut(!0),u=ut(null),o=ut(null),v=null,c,w=ut(800),M=ut(600),_=ut(qt({x:0,y:0,k:1})),h=ut(!1),S=ut(null);const g={healthy:{border:"#22c55e",bg:"rgba(34, 197, 94, 0.1)",glow:"#22c55e"},degraded:{border:"#eab308",bg:"rgba(234, 179, 8, 0.1)",glow:"#eab308"},down:{border:"#ef4444",bg:"rgba(239, 68, 68, 0.1)",glow:"#ef4444"},unknown:{border:"#6b7280",bg:"rgba(107, 114, 128, 0.1)",glow:"#6b7280"}},d={platform:45,service:30,external:35,app:28};async function x(p=!1){R(s,!0),R(u,null);try{const y=`${r.apiUrl}/health/ecosystem${p?"?refresh=true":""}`,j=await fetch(y,{headers:{Authorization:`Bearer ${r.apiSecret}`,Accept:"application/json"}});if(!j.ok)throw new Error(`HTTP ${j.status}`);const D=await j.json(),T=D.nodes.map(H=>({...H,x:void 0,y:void 0})),X=D.edges.map(H=>({source:H.from,target:H.to,label:H.label}));if(t(n).length>0){const H=new Map(t(n).map(J=>[J.id,{x:J.x,y:J.y}]));T.forEach(J=>{const Z=H.get(J.id);Z&&(J.x=Z.x,J.y=Z.y)})}R(n,T,!0),R(a,X,!0),R(i,D.lastCheck,!0),k()}catch(y){R(u,y instanceof Error?y.message:"Failed to fetch",!0)}finally{R(s,!1)}}function k(){v&&v.stop(),v=on(t(n)).force("link",Xr(t(a)).id(p=>p.id).distance(120).strength(.5)).force("charge",sn().strength(-300)).force("center",kr(t(w)/2,t(M)/2)).force("collision",Hr().radius(p=>d[p.type]+10)).force("x",ln().x(p=>p.type==="platform"?t(w)*.5:p.type==="service"?t(w)*.5:p.type==="external"?t(w)*.8:p.type==="app"?t(w)*.2:t(w)/2).strength(.1)).force("y",cn().y(p=>p.parent?t(M)*.6:t(M)*.4).strength(.05)).on("tick",()=>{R(n,[...t(n)],!0),R(a,[...t(a)],!0)}),v.alpha(1).restart(),setTimeout(()=>v?.stop(),3e3)}function z(p,y){v&&(R(h,!0),R(S,y,!0),v.alphaTarget(.3).restart(),y.fx=y.x,y.fy=y.y)}function P(p){if(!t(h)||!t(S))return;const y=c.getBoundingClientRect();t(S).fx=(p.clientX-y.left-t(_).x)/t(_).k,t(S).fy=(p.clientY-y.top-t(_).y)/t(_).k,R(n,[...t(n)],!0)}function B(){!v||!t(S)||(R(h,!1),v.alphaTarget(0),t(S).fx=null,t(S).fy=null,R(S,null))}function lt(p){p.preventDefault();const y=p.deltaY>0?.9:1.1,j=Math.max(.3,Math.min(3,t(_).k*y)),D=c.getBoundingClientRect(),T=p.clientX-D.left,X=p.clientY-D.top;R(_,{k:j,x:T-(T-t(_).x)*j/t(_).k,y:X-(X-t(_).y)*j/t(_).k},!0)}let U=ut(!1),O=ut(qt({x:0,y:0}));function gt(p){t(h)||(R(U,!0),R(O,{x:p.clientX-t(_).x,y:p.clientY-t(_).y},!0))}function rt(p){t(U)&&R(_,{...t(_),x:p.clientX-t(O).x,y:p.clientY-t(O).y},!0)}function ht(){R(U,!1)}function pt(p){R(o,t(o)?.id===p.id?null:p,!0)}function xt(p){const y=typeof p.source=="string"?t(n).find(H=>H.id===p.source):p.source,j=typeof p.target=="string"?t(n).find(H=>H.id===p.target):p.target;if(!y?.x||!y?.y||!j?.x||!j?.y)return"";const D=j.x-y.x,T=j.y-y.y,X=Math.sqrt(D*D+T*T)*.8;return`M${y.x},${y.y}A${X},${X} 0 0,1 ${j.x},${j.y}`}function Ct(){if(c){const p=c.parentElement?.getBoundingClientRect();p&&(R(w,p.width,!0),R(M,p.height,!0))}}let It;nr(()=>{Ct(),x(),It=setInterval(()=>x(),3e4),window.addEventListener("resize",Ct)}),ar(()=>{It&&clearInterval(It),v&&v.stop(),window.removeEventListener("resize",Ct)});var Dt=wn(),Pt=b(Dt);{var zt=p=>{var y=fn(),j=b(y),D=b(j);Ne(D,{class:"w-5 h-5 animate-spin"}),Gt(2),m(j),m(y),$(p,y)};et(Pt,p=>{t(s)&&t(n).length===0&&p(zt)})}var Lt=I(Pt,2);{var Xt=p=>{var y=un(),j=b(y);m(y),K(()=>dt(j,`Failed to load: ${t(u)??""}`)),$(p,y)};et(Lt,p=>{t(u)&&p(Xt)})}var Rt=I(Lt,2),$t=b(Rt);$t.__click=()=>x(!0);var Ut=b($t);{let p=G(()=>t(s)?"animate-spin":"");Ne(Ut,{get class(){return`w-3.5 h-3.5 ${t(p)??""}`}})}Gt(),m($t);var Vt=I($t,2);{var l=p=>{var y=dn(),j=b(y);m(y),K(D=>dt(j,`Last: ${D??""}`),[()=>new Date(t(i)).toLocaleTimeString()]),$(p,y)};et(Vt,p=>{t(i)&&p(l)})}m(Rt);var f=I(Rt,2);f.__mousedown=gt,f.__mousemove=p=>{rt(p),P(p)},f.__mouseup=()=>{ht(),B()};var N=b(f),C=b(N);Nt(C,17,()=>t(a),Et,(p,y)=>{const j=G(()=>xt(t(y)));var D=St(),T=jt(D);{var X=H=>{var J=vn();K(()=>A(J,"d",t(j))),$(H,J)};et(T,H=>{t(j)&&H(X)})}$(p,D)});var L=I(C);Nt(L,17,()=>t(n),Et,(p,y)=>{const j=G(()=>d[t(y).type]),D=G(()=>g[t(y).status]),T=G(()=>t(o)?.id===t(y).id);var X=St(),H=jt(X);{var J=Z=>{var E=hn();E.__mousedown=it=>{it.stopPropagation(),z(it,t(y))},E.__click=()=>pt(t(y)),E.__keydown=it=>it.key==="Enter"&&pt(t(y));var Q=b(E);{var vt=it=>{var Mt=gn();K(()=>{A(Mt,"r",t(j)+4),A(Mt,"fill",t(D).glow)}),$(it,Mt)};et(Q,it=>{t(y).status==="healthy"&&it(vt)})}var ct=I(Q),ft=I(ct),q=I(ft),bt=b(q,!0);m(q);var Y=I(q),V=b(Y,!0);m(Y),m(E),K(()=>{A(E,"transform",`translate(${t(y).x??""}, ${t(y).y??""})`),A(E,"aria-label",`${t(y).label??""} - ${t(y).status??""}`),A(ct,"r",t(j)),A(ct,"fill",t(D).bg),A(ct,"stroke",t(D).border),A(ct,"stroke-width",t(T)?3:2),A(ft,"cx",t(j)-5),A(ft,"cy",-t(j)+5),A(ft,"fill",t(D).border),A(q,"y",t(j)+14),dt(bt,t(y).label),A(Y,"y",t(j)+26),dt(V,t(y).type)}),$(Z,E)};et(H,Z=>{t(y).x!==void 0&&t(y).y!==void 0&&Z(J)})}$(p,X)}),m(N),Gt(),m(f),ir(f,p=>c=p,()=>c);var F=I(f,2);{var tt=p=>{var y=mn(),j=b(y),D=b(j),T=b(D),X=b(T,!0);m(T);var H=I(T,2);H.__click=()=>R(o,null),m(D);var J=I(D,2),Z=b(J),E=I(b(Z),2),Q=b(E,!0);m(E),m(Z);var vt=I(Z,2),ct=I(b(vt),2),ft=b(ct,!0);m(ct),m(vt);var q=I(vt,2);{var bt=nt=>{var st=pn(),kt=I(b(st),2),Wt=b(kt,!0);m(kt),m(st),K(()=>dt(Wt,t(o).parent)),$(nt,st)};et(q,nt=>{t(o).parent&&nt(bt)})}var Y=I(q,2);{var V=nt=>{var st=St(),kt=jt(st);Nt(kt,17,()=>Object.entries(t(o).meta),Et,(Wt,ie)=>{var Tt=G(()=>Je(t(ie),2));let oe=()=>t(Tt)[0],Yt=()=>t(Tt)[1];var Kt=xn(),de=b(Kt),Ue=b(de,!0);m(de);var _e=I(de,2),Ye=b(_e,!0);m(_e),m(Kt),K(()=>{dt(Ue,oe()),dt(Ye,Yt())}),$(Wt,Kt)}),$(nt,st)};et(Y,nt=>{t(o).meta&&nt(V)})}var it=I(Y,2);{var Mt=nt=>{var st=yn(),kt=b(st);or(kt,{class:"w-3.5 h-3.5"}),Gt(),m(st),K(()=>A(st,"href",t(o).url)),$(nt,st)};et(it,nt=>{t(o).url&&nt(Mt)})}m(J),m(j),m(y),K(()=>{dt(X,t(o).label),ge(E,`background-color: ${g[t(o).status].bg??""}; color: ${g[t(o).status].border??""};`),dt(Q,t(o).status),dt(ft,t(o).type)}),$(p,y)};et(F,p=>{t(o)&&p(tt)})}var W=I(F,2),ot=b(W);Nt(ot,20,()=>["healthy","degraded","down","unknown"],Et,(p,y)=>{var j=_n(),D=b(j),T=I(D,2),X=b(T,!0);m(T),m(j),K(()=>{ge(D,`background-color: ${g[y].border??""}`),dt(X,y)}),$(p,j)}),m(ot),m(W),m(Dt),K(()=>{$t.disabled=t(s),yt(f,0,`w-full h-full cursor-grab ${t(U)?"cursor-grabbing":""}`),A(N,"transform",`translate(${t(_).x??""}, ${t(_).y??""}) scale(${t(_).k??""})`),yt(W,1,`absolute bottom-4 left-4 bg-gray-800/90 border border-gray-700 rounded px-3 py-2 text-xs ${t(o)?"hidden md:block":""}`)}),Ht("mouseleave",f,()=>{ht(),B()}),Ht("wheel",f,lt),$(e,Dt),ae()}xe(["click","mousedown","mousemove","mouseup","keydown"]);var kn=at('<div class="absolute top-full right-0 mt-1 bg-gray-800 border border-gray-700 rounded shadow-lg z-10 min-w-[100px]"><button><!> <span>A-Z</span></button> <button><!> <span>Recent</span></button></div>'),Nn=at('<div class="flex items-center gap-3 sm:gap-4"><button class="p-2 text-gray-400 hover:text-gray-200 transition-colors cursor-pointer rounded hover:bg-gray-800"><!></button> <div class="relative sort-dropdown"><button class="flex items-center gap-1 p-1.5 text-gray-400 hover:text-gray-200 cursor-pointer transition-colors"><!> <!></button> <!></div> <div class="flex gap-1 sm:gap-2"><button title="Show jaslr projects">jaslr</button> <button title="Show Vast Puddle projects">VP</button> <button title="Show Junipa projects only">Junipa</button></div></div>'),jn=at('<button class="text-xs text-gray-400 hover:text-gray-200 transition-colors cursor-pointer">Clear filter</button>'),Pn=at('<div class="flex-1 overflow-hidden p-4 sm:p-6"><!></div>'),Mn=at('<div class="text-center text-gray-500 py-8"><p>No projects match the current filters.</p></div>'),Sn=at('<span class="text-gray-300"> </span>'),An=at('<div><img class="w-4 h-4 object-contain"/> <span><!></span> <!></div>'),In=at('<div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 px-4 py-3 bg-gray-800 hover:bg-gray-750 rounded-lg transition-colors"><a class="font-medium text-gray-200 hover:text-white sm:min-w-[160px] truncate shrink-0"> </a> <div class="flex flex-wrap gap-1.5 sm:gap-2 flex-1"></div></div>'),Dn=at('<div class="space-y-2"></div>'),$n=at('<div class="flex-1 overflow-y-auto p-4 sm:p-6"><!></div>'),Cn=at('<a class="text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors text-gray-300 hover:text-white"> </a>'),En=at('<div><button class="w-full text-left group cursor-pointer"><div class="flex items-center justify-between mb-1"><span> </span> <span class="text-xs text-gray-500"> </span></div></button> <div class="flex flex-wrap gap-1.5 mt-2"></div></div>'),zn=at('<div class="bg-gray-800 rounded-lg p-4"><div class="flex items-center gap-2 text-xs text-gray-500 uppercase tracking-wider mb-4"><!> <span> </span></div> <div class="space-y-4"></div></div>'),Rn=at('<div class="shrink-0 border-b border-gray-800 bg-gray-850 svelte-1ny0ztv"><div class="px-6 py-4"><div class="flex items-center justify-between mb-3"><div class="text-xs text-gray-500 uppercase tracking-wider">Ecosystem Flow</div></div> <div class="bg-gray-900 rounded-lg p-4 min-h-[300px]"><!></div></div></div> <div class="flex-1 overflow-y-auto p-6"><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div></div>',1),Tn=at('<div class="flex-1 flex flex-col overflow-hidden"><div class="shrink-0 border-b border-gray-800 bg-gray-900 px-4 sm:px-6 py-3"><div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"><div class="flex gap-1"><button><!> Infrastructure</button> <button>Projects</button> <button>Flow Diagram</button></div> <!></div></div> <!></div>');function fa(e,r){ne(r,!0);const n="https://observatory-backend.fly.dev";let a=G(()=>Ze.data.apiSecret||"");const i=qe(),s=tr();let u=ut("infrastructure");Qt(()=>{const l=localStorage.getItem("ecosystem-active-tab");(l==="projects"||l==="diagram"||l==="infrastructure")&&R(u,l,!0)});function o(l){R(u,l,!0),localStorage.setItem("ecosystem-active-tab",l)}let v=ut("name"),c=ut(!1);function w(l){const f=l.target;t(c)&&!f.closest(".sort-dropdown")&&R(c,!1)}Qt(()=>{if(t(c))return document.addEventListener("click",w),()=>document.removeEventListener("click",w)}),Qt(()=>{const l=localStorage.getItem("ecosystem-sort");(l==="name"||l==="recent")&&R(v,l,!0)});let M=ut(qt({jaslr:!0,vp:!0,junipa:!0}));Qt(()=>{const l=localStorage.getItem("ecosystem-owner-filters");if(l)try{const f=JSON.parse(l);R(M,{jaslr:!0,vp:!0,junipa:!0,...f},!0)}catch{}});function _(l){t(M)[l]=!t(M)[l],localStorage.setItem("ecosystem-owner-filters",JSON.stringify(t(M)))}let h=ut("compact");Qt(()=>{const l=localStorage.getItem("ecosystem-display-mode");(l==="compact"||l==="detailed")&&R(h,l,!0)});function S(){R(h,t(h)==="compact"?"detailed":"compact",!0),localStorage.setItem("ecosystem-display-mode",t(h))}let g=ut(null);function d(l){R(g,t(g)===l?null:l,!0)}function x(){R(g,null)}const k=["hosting","database","auth","storage","monitoring","ci","dns","email","analytics","cdn","secrets"];let z=G(()=>{const l=[];for(const f of s){const N=rr[f.id];if(!N)continue;const C=[...N.services].sort((L,F)=>{const tt=k.indexOf(L.category),W=k.indexOf(F.category);return(tt===-1?999:tt)-(W===-1?999:W)});l.push({id:f.id,displayName:N.displayName,identity:N.identity,services:C.map(L=>({category:L.category,provider:L.provider,serviceName:L.serviceName}))})}return l});function P(l){return l.filter(f=>{const N=f.identity==="jaslr",C=f.identity==="jvp-ux",L=f.id.toLowerCase().includes("junipa")||f.displayName.toLowerCase().includes("junipa");return!!(t(M).junipa&&L||N&&t(M).jaslr&&!L||C&&t(M).vp&&!L)})}let B=G(()=>{const f=[...P(t(z))];return t(v)==="name"&&f.sort((N,C)=>N.displayName.localeCompare(C.displayName)),f});const lt={hosting:Ft,database:se,auth:Pe,storage:er,dns:Se,domain:Se,email:fr,ci:Me,monitoring:ke,analytics:cr,cdn:ve,secrets:Pe},U={cloudflare:"Cloudflare",flyio:"Fly.io",supabase:"Supabase",github:"GitHub",sentry:"Sentry",aws:"AWS",vercel:"Vercel",netlify:"Netlify",google:"Google",gcp:"GCP",pocketbase:"PocketBase"},O={cloudflare:"text-orange-400",supabase:"text-green-400",sentry:"text-purple-400",github:"text-gray-300",aws:"text-yellow-400",vercel:"text-white",flyio:"text-violet-400",google:"text-blue-400",gcp:"text-blue-400",netlify:"text-teal-400",pocketbase:"text-gray-300"};function gt(l){return U[l]||l}const rt={cloudflare:Ft,flyio:Ft,supabase:se,github:Me,sentry:ke,firebase:se,gcp:Ft,aws:Ft,pocketbase:se,vercel:Ft,netlify:Ft};var ht=Tn();Ke("1ny0ztv",l=>{Ve(()=>{We.title="Ecosystem | Orchon"})});var pt=b(ht),xt=b(pt),Ct=b(xt),It=b(Ct);It.__click=()=>o("infrastructure");var Dt=b(It);sr(Dt,{class:"w-4 h-4"}),Gt(),m(It);var Pt=I(It,2);Pt.__click=()=>o("projects");var zt=I(Pt,2);zt.__click=()=>o("diagram"),m(Ct);var Lt=I(Ct,2);{var Xt=l=>{var f=Nn(),N=b(f);N.__click=S;var C=b(N);{var L=E=>{dr(E,{class:"w-4 h-4"})},F=E=>{ur(E,{class:"w-4 h-4"})};et(C,E=>{t(h)==="compact"?E(L):E(F,!1)})}m(N);var tt=I(N,2),W=b(tt);W.__click=()=>R(c,!t(c));var ot=b(W);{var p=E=>{be(E,{class:"w-4 h-4"})},y=E=>{je(E,{class:"w-4 h-4"})};et(ot,E=>{t(v)==="name"?E(p):E(y,!1)})}var j=I(ot,2);lr(j,{class:"w-3 h-3"}),m(W);var D=I(W,2);{var T=E=>{var Q=kn(),vt=b(Q);vt.__click=()=>{R(v,"name"),R(c,!1),localStorage.setItem("ecosystem-sort","name")};var ct=b(vt);be(ct,{class:"w-4 h-4"}),Gt(2),m(vt);var ft=I(vt,2);ft.__click=()=>{R(v,"recent"),R(c,!1),localStorage.setItem("ecosystem-sort","recent")};var q=b(ft);je(q,{class:"w-4 h-4"}),Gt(2),m(ft),m(Q),K(()=>{yt(vt,1,`w-full flex items-center gap-2 px-3 py-2 text-xs text-left cursor-pointer hover:bg-gray-700 transition-colors ${t(v)==="name"?"text-white":"text-gray-400"}`),yt(ft,1,`w-full flex items-center gap-2 px-3 py-2 text-xs text-left cursor-pointer hover:bg-gray-700 transition-colors ${t(v)==="recent"?"text-white":"text-gray-400"}`)}),$(E,Q)};et(D,E=>{t(c)&&E(T)})}m(tt);var X=I(tt,2),H=b(X);H.__click=()=>_("jaslr");var J=I(H,2);J.__click=()=>_("vp");var Z=I(J,2);Z.__click=()=>_("junipa"),m(X),m(f),K(()=>{A(N,"title",t(h)==="compact"?"Show service names":"Hide service names"),A(W,"title",t(v)==="name"?"Sorted A-Z":"Sorted by Recent"),yt(H,1,`px-2 py-1 text-xs cursor-pointer transition-colors rounded ${t(M).jaslr?"text-gray-200 bg-gray-800":"text-gray-500 hover:text-gray-400"}`),yt(J,1,`px-2 py-1 text-xs cursor-pointer transition-colors rounded ${t(M).vp?"text-gray-200 bg-gray-800":"text-gray-500 hover:text-gray-400"}`),yt(Z,1,`px-2 py-1 text-xs cursor-pointer transition-colors rounded ${t(M).junipa?"text-gray-200 bg-gray-800":"text-gray-500 hover:text-gray-400"}`)}),$(l,f)},Rt=l=>{var f=St(),N=jt(f);{var C=L=>{var F=jn();F.__click=x,$(L,F)};et(N,L=>{t(g)&&L(C)},!0)}$(l,f)};et(Lt,l=>{t(u)==="projects"?l(Xt):l(Rt,!1)})}m(xt),m(pt);var $t=I(pt,2);{var Ut=l=>{var f=Pn(),N=b(f);bn(N,{get apiSecret(){return t(a)},apiUrl:n}),m(f),$(l,f)},Vt=l=>{var f=St(),N=jt(f);{var C=F=>{var tt=$n(),W=b(tt);{var ot=y=>{var j=Mn();$(y,j)},p=y=>{var j=Dn();Nt(j,21,()=>t(B),D=>D.id,(D,T)=>{var X=In(),H=b(X),J=b(H,!0);m(H);var Z=I(H,2);Nt(Z,23,()=>t(T).services,(E,Q)=>E.provider+"-"+E.category+"-"+Q,(E,Q)=>{const vt=G(()=>`/api/logos/infra/${t(Q).provider}.svg`),ct=G(()=>rt[t(Q).provider]||ve),ft=G(()=>O[t(Q).provider]||"text-gray-400");var q=An(),bt=b(q),Y=I(bt,2),V=b(Y);we(V,()=>t(ct),(nt,st)=>{st(nt,{class:"w-4 h-4"})}),m(Y);var it=I(Y,2);{var Mt=nt=>{var st=Sn(),kt=b(st,!0);m(st),K(()=>dt(kt,t(Q).serviceName)),$(nt,st)};et(it,nt=>{t(h)==="detailed"&&nt(Mt)})}m(q),K(()=>{yt(q,1,`inline-flex items-center gap-1.5 px-2 py-1 bg-gray-700 rounded text-xs ${t(h)==="compact"?"px-1.5":""}`),A(q,"title",t(Q).serviceName),A(bt,"src",t(vt)),A(bt,"alt",t(Q).provider),yt(Y,1,`hidden ${t(ft)??""}`,"svelte-1ny0ztv")}),Ht("error",bt,nt=>{const st=nt.target;st.style.display="none";const kt=st.nextElementSibling;kt&&kt.classList.remove("hidden")}),Qe(bt),$(E,q)}),m(Z),m(X),K(()=>{A(H,"href",`/projects?project=${t(T).id??""}`),dt(J,t(T).displayName)}),$(D,X)}),m(j),$(y,j)};et(W,y=>{t(B).length===0?y(ot):y(p,!1)})}m(tt),$(F,tt)},L=F=>{var tt=Rn(),W=jt(tt),ot=b(W),p=I(b(ot),2),y=b(p);br(y,{get projects(){return s},get categories(){return i},get selectedProvider(){return t(g)},onProviderClick:d}),m(p),m(ot),m(W);var j=I(W,2),D=b(j);Nt(D,21,()=>i,T=>T.category,(T,X)=>{const H=G(()=>lt[t(X).category]||ve);var J=zn(),Z=b(J),E=b(Z);we(E,()=>t(H),(ft,q)=>{q(ft,{class:"w-4 h-4"})});var Q=I(E,2),vt=b(Q,!0);m(Q),m(Z);var ct=I(Z,2);Nt(ct,21,()=>t(X).providers,ft=>ft.provider,(ft,q)=>{const bt=G(()=>t(g)===t(q).provider),Y=G(()=>t(g)&&!t(bt));var V=En(),it=b(V);it.__click=()=>d(t(q).provider);var Mt=b(it),nt=b(Mt),st=b(nt,!0);m(nt);var kt=I(nt,2),Wt=b(kt);m(kt),m(Mt),m(it);var ie=I(it,2);Nt(ie,21,()=>t(q).projects,Tt=>Tt.id,(Tt,oe)=>{var Yt=Cn(),Kt=b(Yt,!0);m(Yt),K(()=>{A(Yt,"href",`/projects?project=${t(oe).id??""}`),dt(Kt,t(oe).displayName)}),$(Tt,Yt)}),m(ie),m(V),K(Tt=>{yt(V,1,`transition-opacity ${t(Y)?"opacity-30":""}`),yt(nt,1,`font-medium ${(O[t(q).provider]||"text-gray-300")??""} ${t(bt)?"underline":"group-hover:underline"}`,"svelte-1ny0ztv"),dt(st,Tt),dt(Wt,`${t(q).projects.length??""} project${t(q).projects.length!==1?"s":""}`)},[()=>gt(t(q).provider)]),$(ft,V)}),m(ct),m(J),K(()=>dt(vt,t(X).category)),$(T,J)}),m(D),m(j),$(F,tt)};et(N,F=>{t(u)==="projects"?F(C):F(L,!1)},!0)}$(l,f)};et($t,l=>{t(u)==="infrastructure"?l(Ut):l(Vt,!1)})}m(ht),K(()=>{yt(It,1,`px-4 py-2 text-sm font-medium transition-colors cursor-pointer rounded-t flex items-center gap-1.5 ${t(u)==="infrastructure"?"text-white bg-gray-800 border-b-2 border-green-500":"text-gray-400 hover:text-gray-200"}`),yt(Pt,1,`px-4 py-2 text-sm font-medium transition-colors cursor-pointer rounded-t ${t(u)==="projects"?"text-white bg-gray-800 border-b-2 border-blue-500":"text-gray-400 hover:text-gray-200"}`),yt(zt,1,`px-4 py-2 text-sm font-medium transition-colors cursor-pointer rounded-t ${t(u)==="diagram"?"text-white bg-gray-800 border-b-2 border-blue-500":"text-gray-400 hover:text-gray-200"}`)}),$(e,ht),ae()}xe(["click"]);export{fa as component};
