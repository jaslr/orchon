import"../chunks/DsnmJJEf.js";import{p as $,c as B,b as H,n as _e,a as d,d as ee,an as Te,a9 as et,f as m,O as s,aa as V,I as o,P as tt,M as t,ao as at,al as K,N as e,L as z,am as Ce}from"../chunks/bOSu8_9I.js";import{s as fe,d as rt,a as b}from"../chunks/Ctk_jbRy.js";import{i as y}from"../chunks/C3RYBViL.js";import{I as xe,e as X,i as Y,r as Z,s as st,f as Ne,b as Pe,g as Se,a as Me}from"../chunks/CNoyRSNi.js";import{c as ot}from"../chunks/CLEP-BiZ.js";import{h as it}from"../chunks/Bha2itWB.js";import{a as ue,e as me}from"../chunks/DephRoQt.js";import{b as De}from"../chunks/BtgbrfCX.js";import{i as nt}from"../chunks/DBLdSKmK.js";import{R as je}from"../chunks/CeJG3NcX.js";import{D as lt,T as dt}from"../chunks/Cldhpsde.js";import{P as vt}from"../chunks/DGJCo_Ae.js";import{C as pe,a as ge}from"../chunks/8w5CS6qf.js";import{s as he,r as be}from"../chunks/Di9dn3sX.js";import{T as ct}from"../chunks/C5Oc2MIu.js";import{C as ut}from"../chunks/BhsAfQsw.js";import{C as Oe}from"../chunks/DdP2pKCi.js";function mt(F,l){$(l,!0);let T=be(l,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}],["path",{d:"M9 18c-4.51 2-5-2-7-2"}]];xe(F,he({name:"github"},()=>T,{get iconNode(){return g},children:(G,Q)=>{var C=B(),J=H(C);fe(J,()=>l.children??_e),d(G,C)},$$slots:{default:!0}})),ee()}function Re(F,l){$(l,!0);let T=be(l,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]];xe(F,he({name:"play"},()=>T,{get iconNode(){return g},children:(G,Q)=>{var C=B(),J=H(C);fe(J,()=>l.children??_e),d(G,C)},$$slots:{default:!0}})),ee()}function pt(F,l){$(l,!0);let T=be(l,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 19h8"}],["path",{d:"m4 17 6-6-6-6"}]];xe(F,he({name:"terminal"},()=>T,{get iconNode(){return g},children:(G,Q)=>{var C=B(),J=H(C);fe(J,()=>l.children??_e),d(G,C)},$$slots:{default:!0}})),ee()}var gt=m('<div class="p-4 bg-green-900/30 border border-green-700 rounded-lg text-green-400"> </div>'),_t=m('<div class="p-4 bg-red-900/30 border border-red-700 rounded-lg text-red-400"> </div>'),ft=m('<!> <span class="text-green-400 font-medium">Connected</span>',1),xt=m('<span class="text-gray-500 text-sm"> </span>'),ht=m('<!> <span class="text-red-400 font-medium">Disconnected</span> <!>',1),bt=m('<p class="text-gray-500">No services to display</p>'),yt=m('<div class="bg-gray-900/50 rounded-lg p-4"><div class="flex items-start justify-between"><div class="min-w-0"><p class="font-medium text-white truncate"> </p> <p class="text-sm text-gray-500 truncate"> </p></div> <div class="shrink-0 ml-2"><!></div></div> <div class="mt-2 flex items-center gap-2 text-xs text-gray-500"><span class="px-1.5 py-0.5 bg-gray-800 rounded"> </span> <span> </span></div></div>'),wt=m('<div class="grid gap-3 sm:grid-cols-2 lg:grid-cols-3"></div>'),At=m("<option> </option>"),It=m('<form method="POST" action="?/createAction" class="bg-gray-900/50 rounded-lg p-4 mb-4 space-y-4"><div class="grid gap-4 sm:grid-cols-2"><div><label class="block text-sm text-gray-400 mb-1">Service ID</label> <select name="serviceId" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white"><option>Select service...</option><!></select></div> <div><label class="block text-sm text-gray-400 mb-1">Action Name</label> <input type="text" name="name" required placeholder="e.g., Restart Backend" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white"/></div></div> <div class="grid gap-4 sm:grid-cols-2"><div><label class="block text-sm text-gray-400 mb-1">Action Type</label> <select name="actionType" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white"><option>Fly.io API</option><option>GitHub Workflow</option><option>GCP API</option><option>SSH Command</option></select></div> <div><label class="block text-sm text-gray-400 mb-1">Config (JSON)</label> <input type="text" name="config" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white font-mono text-sm"/></div></div> <div class="flex justify-end gap-2"><button type="button" class="px-4 py-2 text-gray-400 hover:text-white transition-colors">Cancel</button> <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white transition-colors">Create Action</button></div></form>'),kt=m('<p class="text-gray-500">No recovery actions configured</p>'),Tt=m('<div class="bg-gray-900/50 rounded-lg p-4 flex items-center justify-between"><div class="flex items-center gap-3 min-w-0"><div class="p-2 bg-gray-800 rounded-lg"><!></div> <div class="min-w-0"><p class="font-medium text-white"> </p> <p class="text-sm text-gray-500 truncate"> </p></div></div> <div class="flex items-center gap-2 shrink-0"><form method="POST" action="?/execute"><input type="hidden" name="actionId"/> <button type="submit" class="flex items-center gap-2 px-3 py-1.5 bg-green-600 hover:bg-green-500 rounded-lg text-sm text-white transition-colors"><!> Execute</button></form> <form method="POST" action="?/deleteAction"><input type="hidden" name="actionId"/> <button type="submit" class="p-2 text-gray-500 hover:text-red-400 transition-colors" title="Delete action"><!></button></form></div></div>'),Ct=m('<div class="space-y-3"></div>'),Nt=m('<p class="text-gray-500">No executions yet</p>'),Pt=m('<div class="flex items-center gap-4 p-3 bg-gray-900/50 rounded-lg"><div><!></div> <div class="flex-1 min-w-0"><p class="text-white font-medium truncate"> </p> <p class="text-sm text-gray-500"> </p></div> <div class="text-right text-sm shrink-0"><p> </p> <p class="text-gray-500"> </p></div></div>'),St=m('<div class="space-y-2"></div>'),Mt=m('<div class="p-6 space-y-8"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-white">Infrastructure Control</h1> <p class="text-gray-400 text-sm mt-1">Monitor health and trigger recovery actions</p></div> <button class="flex items-center gap-2 px-3 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm text-gray-300 transition-colors"><!> Refresh</button></div> <!> <!> <section class="bg-gray-800/50 rounded-xl p-6"><div class="flex items-center gap-3 mb-4"><!> <h2 class="text-lg font-semibold text-white">Database</h2></div> <div class="flex items-center gap-3"><!></div></section> <section class="bg-gray-800/50 rounded-xl p-6"><h2 class="text-lg font-semibold text-white mb-4">Service Health</h2> <!></section> <section class="bg-gray-800/50 rounded-xl p-6"><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-semibold text-white">Recovery Actions</h2> <button class="flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 rounded-lg text-sm text-white transition-colors"><!> Add Action</button></div> <!> <!></section> <section class="bg-gray-800/50 rounded-xl p-6"><h2 class="text-lg font-semibold text-white mb-4">Execution Log</h2> <!></section></div>');function Xt(F,l){$(l,!0);let T=Te(!1),g=Te(et({serviceId:"",name:"",actionType:"fly-api",config:"{}"}));function G(a){switch(a){case"healthy":case"success":return"text-green-400";case"degraded":case"running":return"text-yellow-400";case"down":case"failure":return"text-red-400";default:return"text-gray-400"}}function Q(a){switch(a){case"fly-api":return ut;case"github-workflow":return mt;case"ssh-command":return pt;default:return Re}}function C(a){if(!a)return"Never";const r=new Date(a),i=new Date().getTime()-r.getTime(),u=Math.floor(i/6e4),v=Math.floor(i/36e5);return u<1?"Just now":u<60?`${u}m ago`:v<24?`${v}h ago`:r.toLocaleDateString()}let J=Ce(()=>{const a=new Set;for(const r of l.data.health.services)a.add(r.id);return Array.from(a).sort()});var te=Mt();it("1p5hgyd",a=>{tt(()=>{at.title="Infrastructure | Orchon Admin"})});var ae=t(te),re=s(t(ae),2);re.__click=()=>nt();var qe=t(re);je(qe,{class:"w-4 h-4"}),K(),e(re),e(ae);var ye=s(ae,2);{var He=a=>{var r=gt(),c=t(r,!0);e(r),z(()=>b(c,l.form.message||"Action completed successfully")),d(a,r)};y(ye,a=>{l.form?.success&&a(He)})}var we=s(ye,2);{var Ge=a=>{var r=_t(),c=t(r,!0);e(r),z(()=>b(c,l.form.error)),d(a,r)};y(we,a=>{l.form?.error&&a(Ge)})}var se=s(we,2),oe=t(se),Le=t(oe);lt(Le,{class:"w-5 h-5 text-gray-400"}),K(2),e(oe);var Ae=s(oe,2),Ee=t(Ae);{var Fe=a=>{var r=ft(),c=H(r);pe(c,{class:"w-6 h-6 text-green-400"}),K(2),d(a,r)},Je=a=>{var r=ht(),c=H(r);ge(c,{class:"w-6 h-6 text-red-400"});var i=s(c,4);{var u=v=>{var _=xt(),h=t(_);e(_),z(()=>b(h,`(${l.data.health.database.message??""})`)),d(v,_)};y(i,v=>{l.data.health.database.message&&v(u)})}d(a,r)};y(Ee,a=>{l.data.health.database.connected?a(Fe):a(Je,!1)})}e(Ae),e(se);var ie=s(se,2),ze=s(t(ie),2);{var Be=a=>{var r=bt();d(a,r)},We=a=>{var r=wt();X(r,21,()=>l.data.health.services,Y,(c,i)=>{var u=yt(),v=t(u),_=t(v),h=t(_),L=t(h,!0);e(h);var w=s(h,2),A=t(w,!0);e(w),e(_);var j=s(_,2),N=t(j);{var O=n=>{pe(n,{class:"w-5 h-5 text-green-400"})},P=n=>{var x=B(),M=H(x);{var D=q=>{dt(q,{class:"w-5 h-5 text-yellow-400"})},I=q=>{var U=B(),ve=H(U);{var ce=W=>{ge(W,{class:"w-5 h-5 text-red-400"})},E=W=>{Oe(W,{class:"w-5 h-5 text-gray-500"})};y(ve,W=>{o(i).status==="down"?W(ce):W(E,!1)},!0)}d(q,U)};y(M,q=>{o(i).status==="degraded"?q(D):q(I,!1)},!0)}d(n,x)};y(N,n=>{o(i).status==="healthy"?n(O):n(P,!1)})}e(j),e(v);var f=s(v,2),k=t(f),S=t(k,!0);e(k);var R=s(k,2),p=t(R,!0);e(R),e(f),e(u),z(n=>{b(L,o(i).id),b(A,o(i).projectName),b(S,o(i).provider),b(p,n)},[()=>C(o(i).lastChecked)]),d(c,u)}),e(r),d(a,r)};y(ze,a=>{l.data.health.services.length===0?a(Be):a(We,!1)})}e(ie);var ne=s(ie,2),le=t(ne),de=s(t(le),2);de.__click=()=>V(T,!o(T));var Ke=t(de);vt(Ke,{class:"w-4 h-4"}),K(),e(de),e(le);var Ie=s(le,2);{var Qe=a=>{var r=It(),c=t(r),i=t(c),u=s(t(i),2),v=t(u);v.value=v.__value="";var _=s(v);X(_,17,()=>o(J),Y,(n,x)=>{var M=At(),D=t(M,!0);e(M);var I={};z(()=>{b(D,o(x)),I!==(I=o(x))&&(M.value=(M.__value=o(x))??"")}),d(n,M)}),e(u),e(i);var h=s(i,2),L=s(t(h),2);Z(L),e(h),e(c);var w=s(c,2),A=t(w),j=s(t(A),2),N=t(j);N.value=N.__value="fly-api";var O=s(N);O.value=O.__value="github-workflow";var P=s(O);P.value=P.__value="gcp-api";var f=s(P);f.value=f.__value="ssh-command",e(j),e(A);var k=s(A,2),S=s(t(k),2);Z(S),st(S,"placeholder",'{"app": "my-app", "action": "restart"}'),e(k),e(w);var R=s(w,2),p=t(R);p.__click=()=>V(T,!1),K(2),e(R),e(r),ue(r,(n,x)=>me?.(n,x),()=>()=>async({update:n})=>{await n(),V(T,!1),V(g,{serviceId:"",name:"",actionType:"fly-api",config:"{}"},!0)}),Ne(u,()=>o(g).serviceId,n=>o(g).serviceId=n),De(L,()=>o(g).name,n=>o(g).name=n),Ne(j,()=>o(g).actionType,n=>o(g).actionType=n),De(S,()=>o(g).config,n=>o(g).config=n),d(a,r)};y(Ie,a=>{o(T)&&a(Qe)})}var Ue=s(Ie,2);{var Ve=a=>{var r=kt();d(a,r)},Xe=a=>{var r=Ct();X(r,21,()=>l.data.actions,Y,(c,i)=>{const u=Ce(()=>Q(o(i).actionType));var v=Tt(),_=t(v),h=t(_),L=t(h);ot(L,()=>o(u),(D,I)=>{I(D,{class:"w-5 h-5 text-gray-400"})}),e(h);var w=s(h,2),A=t(w),j=t(A,!0);e(A);var N=s(A,2),O=t(N,!0);e(N),e(w),e(_);var P=s(_,2),f=t(P),k=t(f);Z(k);var S=s(k,2),R=t(S);Re(R,{class:"w-4 h-4"}),K(),e(S),e(f),ue(f,D=>me?.(D));var p=s(f,2),n=t(p);Z(n);var x=s(n,2),M=t(x);ct(M,{class:"w-4 h-4"}),e(x),e(p),ue(p,D=>me?.(D)),e(P),e(v),z(()=>{b(j,o(i).name),b(O,o(i).serviceId),Pe(k,o(i).id),Pe(n,o(i).id)}),d(c,v)}),e(r),d(a,r)};y(Ue,a=>{l.data.actions.length===0?a(Ve):a(Xe,!1)})}e(ne);var ke=s(ne,2),Ye=s(t(ke),2);{var Ze=a=>{var r=Nt();d(a,r)},$e=a=>{var r=St();X(r,21,()=>l.data.executions,Y,(c,i)=>{var u=Pt(),v=t(u),_=t(v);{var h=p=>{pe(p,{class:"w-5 h-5"})},L=p=>{var n=B(),x=H(n);{var M=I=>{ge(I,{class:"w-5 h-5"})},D=I=>{var q=B(),U=H(q);{var ve=E=>{je(E,{class:"w-5 h-5 animate-spin"})},ce=E=>{Oe(E,{class:"w-5 h-5"})};y(U,E=>{o(i).status==="running"?E(ve):E(ce,!1)},!0)}d(I,q)};y(x,I=>{o(i).status==="failure"?I(M):I(D,!1)},!0)}d(p,n)};y(_,p=>{o(i).status==="success"?p(h):p(L,!1)})}e(v);var w=s(v,2),A=t(w),j=t(A,!0);e(A);var N=s(A,2),O=t(N,!0);e(N),e(w);var P=s(w,2),f=t(P),k=t(f,!0);e(f);var S=s(f,2),R=t(S,!0);e(S),e(P),e(u),z((p,n,x)=>{Me(v,1,p),b(j,o(i).actionName),b(O,o(i).serviceId),Me(f,1,n),b(k,o(i).status),b(R,x)},[()=>Se(G(o(i).status)),()=>Se(G(o(i).status)),()=>C(o(i).startedAt)]),d(c,u)}),e(r),d(a,r)};y(Ye,a=>{l.data.executions.length===0?a(Ze):a($e,!1)})}e(ke),e(te),d(F,te),ee()}rt(["click"]);export{Xt as component};
