import"../chunks/DsnmJJEf.js";import{h as Xt,j as Kt,aq as Wt,k as Yt,p as mt,d as gt,c as F,b as N,a as d,n as Zt,an as K,a9 as ut,D as dt,aa as $,I as e,f as p,O as u,M as n,L as w,P as te,ao as ee,N as o,am as U}from"../chunks/bOSu8_9I.js";import{B as re,s as ae,d as se,a as h}from"../chunks/Ctk_jbRy.js";import{i as b}from"../chunks/C3RYBViL.js";import{I as oe,e as W,c as ne,i as ft,d as ie,a as _t,s as xt}from"../chunks/CNoyRSNi.js";import{h as le}from"../chunks/Bha2itWB.js";import{g as ce}from"../chunks/DBLdSKmK.js";import{s as ve,r as ue}from"../chunks/Di9dn3sX.js";import{X as de}from"../chunks/C9ePCuFK.js";import{C as pt}from"../chunks/BhsAfQsw.js";import{C as fe}from"../chunks/DdP2pKCi.js";import{L as _e}from"../chunks/CAAZjQWN.js";import{G as xe}from"../chunks/BMKZ75K2.js";import{E as pe}from"../chunks/D3M7jnZE.js";import{C as me,a as ge}from"../chunks/8w5CS6qf.js";function he(L,m,f){Xt&&Kt();var g=new re(L),k=!Wt();Yt(()=>{var D=m();k&&D!==null&&typeof D=="object"&&(D={}),g.ensure(D,f)})}function be(L,m){mt(m,!0);let f=ue(m,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"}]];oe(L,ve({name:"funnel"},()=>f,{get iconNode(){return g},children:(k,D)=>{var S=F(),O=N(S);ae(O,()=>m.children??Zt),d(k,S)},$$slots:{default:!0}})),gt()}var we=p("<option> </option>"),ye=p('<button class="flex items-center gap-1 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-500 transition-colors"> <!></button>'),ke=p('<button class="px-2 py-0.5 text-xs bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded transition-colors"> </button>'),De=p('<div class="flex flex-wrap items-center gap-2"><span class="text-xs text-gray-500">Recent:</span> <!></div>'),Ae=p('<p class="text-sm mt-1">Try selecting a different project or clear the filter</p>'),Te=p('<div class="p-8 text-center text-gray-500"><!> <p class="text-lg">No deployments found</p> <!></div>'),Se=p('<span class="flex items-center gap-1"><!> </span>'),je=p('<a target="_blank" rel="noopener noreferrer" class="font-mono text-xs hover:text-blue-400 transition-colors"> </a>'),Ce=p('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-1 hover:text-blue-400 transition-colors">View logs <!></a>'),Me=p("<div> </div>"),Le=p('<div class="text-xs text-gray-600 mt-0.5"> </div>'),$e=p('<div class="px-4 py-4 hover:bg-gray-800/30 transition-colors"><div class="flex items-start gap-4"><div class="shrink-0 mt-0.5"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 flex-wrap"><button class="font-medium text-white hover:text-blue-400 transition-colors"> </button> <span> </span> <span class="text-xs text-gray-600 capitalize"> </span></div> <div class="flex items-center gap-4 mt-1.5 text-sm text-gray-500"><!> <!> <!></div></div> <div class="shrink-0 text-right"><div class="flex items-center gap-1.5 text-sm text-gray-400"><!> </div> <!></div></div></div>'),Pe=p('<div class="divide-y divide-gray-800"></div>'),Ie=p('<div class="flex-1 flex flex-col h-full overflow-hidden"><div class="shrink-0 px-4 py-4 border-b border-gray-800 bg-gray-900/50"><div class="flex flex-col gap-3"><div class="flex items-center justify-between"><h1 class="text-lg font-semibold text-white">Deployment Log</h1> <span class="text-sm text-gray-500"> </span></div> <div class="flex flex-wrap items-center gap-2"><!> <select class="bg-gray-800 border border-gray-700 rounded px-3 py-1.5 text-sm text-gray-300 focus:outline-none focus:border-blue-500"><option>All Projects</option><!></select> <!></div> <!></div></div> <div class="flex-1 overflow-y-auto"><!></div></div>');function Ke(L,m){mt(m,!0);let f=K(ut(m.data.projectFilter)),g=K(ut([]));dt(()=>{{const t=localStorage.getItem("orchon-recent-project-filters");if(t)try{$(g,JSON.parse(t),!0)}catch{$(g,[],!0)}}});let k=U(()=>[...e(f)?m.data.deployments.filter(r=>r.projectName===e(f)):m.data.deployments].sort((r,a)=>{const s=r.status==="in_progress"||r.status==="queued",c=a.status==="in_progress"||a.status==="queued";if(s&&!c)return-1;if(!s&&c)return 1;const v=new Date(r.deployCompletedAt||r.completedAt||r.startedAt||0).getTime();return new Date(a.deployCompletedAt||a.completedAt||a.startedAt||0).getTime()-v}));function D(t){return m.data.projects.find(a=>a.id===t)?.name||t}function S(t){$(f,t,!0);{const r=new URL(window.location.href);t?r.searchParams.set("project",t):r.searchParams.delete("project"),ce(r.toString(),{replaceState:!0,noScroll:!0}),t&&!e(g).includes(t)&&($(g,[t,...e(g).filter(a=>a!==t)].slice(0,5),!0),localStorage.setItem("orchon-recent-project-filters",JSON.stringify(e(g))))}}function O(t){if(!t)return"Unknown";const r=new Date(t),s=new Date().getTime()-r.getTime(),c=Math.floor(s/6e4),v=Math.floor(s/36e5),_=Math.floor(s/864e5);return c<1?"just now":c<60?`${c}m ago`:v<24?`${v}h ago`:_<7?`${_}d ago`:r.toLocaleDateString()}function ht(t){return t?new Date(t).toLocaleString():""}function bt(t){switch(t){case"success":return"text-green-400";case"failure":return"text-red-400";case"in_progress":return"text-cyan-400";default:return"text-gray-400"}}function wt(t){switch(t){case"success":return"Success";case"failure":return"Failed";case"in_progress":return"Deploying";case"queued":return"Queued";default:return"Unknown"}}function Y(t){const r=Math.floor(t/1e3),a=Math.floor(r/60),s=Math.floor(a/60);return s>0?`${s}h ${a%60}m`:a>0?`${a}m ${r%60}s`:`${r}s`}function yt(t){const r=t.status,a=t.ciStartedAt||t.startedAt,s=t.deployCompletedAt||t.completedAt;if(r==="in_progress"||r==="queued"){if(!a)return null;const c=new Date(a).getTime(),v=Date.now()-c;return{text:`running ${Y(v)}`,color:"text-cyan-400"}}else if(r==="success"||r==="failure"){if(!a||!s)return null;const c=new Date(a).getTime(),_=new Date(s).getTime()-c;if(_<0)return null;const j=r==="failure"?"failed after":"took",P=r==="failure"?"text-red-400":"text-green-400";return{text:`${j} ${Y(_)}`,color:P}}return null}let z=K(0);dt(()=>{{const t=setInterval(()=>{$(z,e(z)+1)},1e4);return()=>clearInterval(t)}});var R=Ie();le("1tckhxz",t=>{te(()=>{ee.title="Deployments | Orchon"})});var B=n(R),Z=n(B),E=n(Z),tt=u(n(E),2),kt=n(tt);o(tt),o(E);var G=u(E,2),et=n(G);be(et,{class:"w-4 h-4 text-gray-500 shrink-0"});var A=u(et,2);A.__change=t=>S(t.currentTarget.value||null);var H=n(A);H.value=H.__value="";var Dt=u(H);W(Dt,17,()=>m.data.projects,ft,(t,r)=>{var a=we(),s=n(a,!0);o(a);var c={};w(()=>{h(s,e(r).name),c!==(c=e(r).id)&&(a.value=(a.__value=e(r).id)??"")}),d(t,a)}),o(A);var rt;ne(A);var At=u(A,2);{var Tt=t=>{var r=ye();r.__click=()=>S(null);var a=n(r),s=u(a);de(s,{class:"w-3 h-3"}),o(r),w(c=>h(a,`${c??""} `),[()=>D(e(f))]),d(t,r)};b(At,t=>{e(f)&&t(Tt)})}o(G);var St=u(G,2);{var jt=t=>{var r=De(),a=u(n(r),2);W(a,17,()=>e(g),ft,(s,c)=>{var v=ke();v.__click=()=>S(e(c));var _=n(v,!0);o(v),w(j=>h(_,j),[()=>D(e(c))]),d(s,v)}),o(r),d(t,r)};b(St,t=>{e(g).length>0&&!e(f)&&t(jt)})}o(Z),o(B);var at=u(B,2),Ct=n(at);{var Mt=t=>{var r=Te(),a=n(r);pt(a,{class:"w-12 h-12 mx-auto mb-3 opacity-50"});var s=u(a,4);{var c=v=>{var _=Ae();d(v,_)};b(s,v=>{e(f)&&v(c)})}o(r),d(t,r)},Lt=t=>{var r=Pe();W(r,21,()=>e(k),a=>a.id,(a,s)=>{const c=U(()=>e(s).deployCompletedAt||e(s).completedAt||e(s).startedAt),v=U(()=>e(s).status),_=U(()=>yt(e(s)));var j=$e(),P=n(j),J=n(P),$t=n(J);{var Pt=i=>{_e(i,{class:"w-5 h-5 text-cyan-400 animate-spin"})},It=i=>{var l=F(),x=N(l);{var y=T=>{me(T,{class:"w-5 h-5 text-green-400"})},C=T=>{var vt=F(),Jt=N(vt);{var Qt=M=>{ge(M,{class:"w-5 h-5 text-red-400"})},Vt=M=>{pt(M,{class:"w-5 h-5 text-gray-500"})};b(Jt,M=>{e(v)==="failure"?M(Qt):M(Vt,!1)},!0)}d(T,vt)};b(x,T=>{e(v)==="success"?T(y):T(C,!1)},!0)}d(i,l)};b($t,i=>{e(v)==="in_progress"?i(Pt):i(It,!1)})}o(J);var Q=u(J,2),V=n(Q),I=n(V);I.__click=()=>S(e(s).projectName);var qt=n(I,!0);o(I);var q=u(I,2),Ut=n(q,!0);o(q);var st=u(q,2),Ft=n(st,!0);o(st),o(V);var ot=u(V,2),nt=n(ot);{var Nt=i=>{var l=Se(),x=n(l);xe(x,{class:"w-3.5 h-3.5"});var y=u(x);o(l),w(()=>h(y,` ${e(s).branch??""}`)),d(i,l)};b(nt,i=>{e(s).branch&&i(Nt)})}var it=u(nt,2);{var Ot=i=>{var l=je(),x=n(l,!0);o(l),w(y=>{xt(l,"href",`https://github.com/jaslr/${e(s).projectName??""}/commit/${e(s).commitSha??""}`),h(x,y)},[()=>e(s).commitSha.slice(0,7)]),d(i,l)};b(it,i=>{e(s).commitSha&&i(Ot)})}var zt=u(it,2);{var Rt=i=>{var l=Ce(),x=u(n(l));pe(x,{class:"w-3 h-3"}),o(l),w(()=>xt(l,"href",e(s).runUrl)),d(i,l)};b(zt,i=>{e(s).runUrl&&i(Rt)})}o(ot),o(Q);var lt=u(Q,2),X=n(lt),ct=n(X);fe(ct,{class:"w-3.5 h-3.5"});var Bt=u(ct);o(X);var Et=u(X,2);{var Gt=i=>{var l=F(),x=N(l);he(x,()=>e(z),y=>{var C=Me(),T=n(C,!0);o(C),w(()=>{_t(C,1,`text-xs font-medium mt-0.5 ${e(_).color??""}`),h(T,e(_).text)}),d(y,C)}),d(i,l)},Ht=i=>{var l=Le(),x=n(l,!0);o(l),w(y=>h(x,y),[()=>ht(e(c))]),d(i,l)};b(Et,i=>{e(_)?i(Gt):i(Ht,!1)})}o(lt),o(P),o(j),w((i,l,x)=>{h(qt,e(s).projectDisplayName||e(s).projectName),_t(q,1,`text-xs px-1.5 py-0.5 rounded ${i??""} bg-gray-800`),h(Ut,l),h(Ft,e(s).provider),h(Bt,` ${x??""}`)},[()=>bt(e(v)),()=>wt(e(v)),()=>O(e(c))]),d(a,j)}),o(r),d(t,r)};b(Ct,t=>{e(k).length===0?t(Mt):t(Lt,!1)})}o(at),o(R),w(()=>{h(kt,`${e(k).length??""} deployment${e(k).length!==1?"s":""}`),rt!==(rt=e(f)||"")&&(A.value=(A.__value=e(f)||"")??"",ie(A,e(f)||""))}),d(L,R),gt()}se(["change","click"]);export{Ke as component};
