import"../chunks/DsnmJJEf.js";import{p as $,k as B,l as H,o as ft,c as d,d as tt,s as Tt,a as te,f as m,j as s,b as V,g as o,h as ee,i as e,$ as ae,n as K,r as t,t as z,e as Ct}from"../chunks/VB45bhtT.js";import{s as b}from"../chunks/CgppWemH.js";import{i as y}from"../chunks/CuIfUMuc.js";import{e as X,i as Y,c as Nt,s as Pt}from"../chunks/oRfbssuc.js";import{c as re}from"../chunks/B2L2jHYA.js";import{h as se}from"../chunks/B2E4lz1E.js";import{a as ut,e as mt}from"../chunks/CdHnUH1e.js";import{I as _t,r as Z,s as oe,c as St,a as Dt}from"../chunks/Dnptkdu8.js";import{d as ie}from"../chunks/D3xLfT3q.js";import{b as Mt}from"../chunks/Cuy74Y2K.js";import{i as ne}from"../chunks/DUFUtOrg.js";import{R as jt}from"../chunks/CvOgw8TE.js";import{D as le}from"../chunks/BX3HDoUx.js";import{P as de}from"../chunks/DldiDE7P.js";import{C as pt,a as gt}from"../chunks/Bgf0s5Dt.js";import{s as xt}from"../chunks/CNKuqfku.js";import{s as ht,r as bt}from"../chunks/Vb7vi_9G.js";import{T as ve}from"../chunks/zswCIXf2.js";import{C as ce}from"../chunks/33od3G62.js";import{T as ue}from"../chunks/CwEf2ijl.js";import{C as Rt}from"../chunks/rPvbTGdw.js";function me(J,l){$(l,!0);let T=bt(l,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}],["path",{d:"M9 18c-4.51 2-5-2-7-2"}]];_t(J,ht({name:"github"},()=>T,{get iconNode(){return g},children:(G,Q)=>{var C=B(),L=H(C);xt(L,()=>l.children??ft),d(G,C)},$$slots:{default:!0}})),tt()}function Ot(J,l){$(l,!0);let T=bt(l,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"}]];_t(J,ht({name:"play"},()=>T,{get iconNode(){return g},children:(G,Q)=>{var C=B(),L=H(C);xt(L,()=>l.children??ft),d(G,C)},$$slots:{default:!0}})),tt()}function pe(J,l){$(l,!0);let T=bt(l,["$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 19h8"}],["path",{d:"m4 17 6-6-6-6"}]];_t(J,ht({name:"terminal"},()=>T,{get iconNode(){return g},children:(G,Q)=>{var C=B(),L=H(C);xt(L,()=>l.children??ft),d(G,C)},$$slots:{default:!0}})),tt()}var ge=m('<div class="p-4 bg-green-900/30 border border-green-700 rounded-lg text-green-400"> </div>'),fe=m('<div class="p-4 bg-red-900/30 border border-red-700 rounded-lg text-red-400"> </div>'),_e=m('<!> <span class="text-green-400 font-medium">Connected</span>',1),xe=m('<span class="text-gray-500 text-sm"> </span>'),he=m('<!> <span class="text-red-400 font-medium">Disconnected</span> <!>',1),be=m('<p class="text-gray-500">No services to display</p>'),ye=m('<div class="bg-gray-900/50 rounded-lg p-4"><div class="flex items-start justify-between"><div class="min-w-0"><p class="font-medium text-white truncate"> </p> <p class="text-sm text-gray-500 truncate"> </p></div> <div class="shrink-0 ml-2"><!></div></div> <div class="mt-2 flex items-center gap-2 text-xs text-gray-500"><span class="px-1.5 py-0.5 bg-gray-800 rounded"> </span> <span> </span></div></div>'),we=m('<div class="grid gap-3 sm:grid-cols-2 lg:grid-cols-3"></div>'),ke=m("<option> </option>"),Ae=m('<form method="POST" action="?/createAction" class="bg-gray-900/50 rounded-lg p-4 mb-4 space-y-4"><div class="grid gap-4 sm:grid-cols-2"><div><label class="block text-sm text-gray-400 mb-1">Service ID</label> <select name="serviceId" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white"><option>Select service...</option><!></select></div> <div><label class="block text-sm text-gray-400 mb-1">Action Name</label> <input type="text" name="name" required placeholder="e.g., Restart Backend" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white"/></div></div> <div class="grid gap-4 sm:grid-cols-2"><div><label class="block text-sm text-gray-400 mb-1">Action Type</label> <select name="actionType" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white"><option>Fly.io API</option><option>GitHub Workflow</option><option>GCP API</option><option>SSH Command</option></select></div> <div><label class="block text-sm text-gray-400 mb-1">Config (JSON)</label> <input type="text" name="config" required class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white font-mono text-sm"/></div></div> <div class="flex justify-end gap-2"><button type="button" class="px-4 py-2 text-gray-400 hover:text-white transition-colors">Cancel</button> <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white transition-colors">Create Action</button></div></form>'),Ie=m('<p class="text-gray-500">No recovery actions configured</p>'),Te=m('<div class="bg-gray-900/50 rounded-lg p-4 flex items-center justify-between"><div class="flex items-center gap-3 min-w-0"><div class="p-2 bg-gray-800 rounded-lg"><!></div> <div class="min-w-0"><p class="font-medium text-white"> </p> <p class="text-sm text-gray-500 truncate"> </p></div></div> <div class="flex items-center gap-2 shrink-0"><form method="POST" action="?/execute"><input type="hidden" name="actionId"/> <button type="submit" class="flex items-center gap-2 px-3 py-1.5 bg-green-600 hover:bg-green-500 rounded-lg text-sm text-white transition-colors"><!> Execute</button></form> <form method="POST" action="?/deleteAction"><input type="hidden" name="actionId"/> <button type="submit" class="p-2 text-gray-500 hover:text-red-400 transition-colors" title="Delete action"><!></button></form></div></div>'),Ce=m('<div class="space-y-3"></div>'),Ne=m('<p class="text-gray-500">No executions yet</p>'),Pe=m('<div class="flex items-center gap-4 p-3 bg-gray-900/50 rounded-lg"><div><!></div> <div class="flex-1 min-w-0"><p class="text-white font-medium truncate"> </p> <p class="text-sm text-gray-500"> </p></div> <div class="text-right text-sm shrink-0"><p> </p> <p class="text-gray-500"> </p></div></div>'),Se=m('<div class="space-y-2"></div>'),De=m('<div class="p-6 space-y-8"><div class="flex items-center justify-between"><div><h1 class="text-2xl font-bold text-white">Infrastructure Control</h1> <p class="text-gray-400 text-sm mt-1">Monitor health and trigger recovery actions</p></div> <button class="flex items-center gap-2 px-3 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm text-gray-300 transition-colors"><!> Refresh</button></div> <!> <!> <section class="bg-gray-800/50 rounded-xl p-6"><div class="flex items-center gap-3 mb-4"><!> <h2 class="text-lg font-semibold text-white">Database</h2></div> <div class="flex items-center gap-3"><!></div></section> <section class="bg-gray-800/50 rounded-xl p-6"><h2 class="text-lg font-semibold text-white mb-4">Service Health</h2> <!></section> <section class="bg-gray-800/50 rounded-xl p-6"><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-semibold text-white">Recovery Actions</h2> <button class="flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-500 rounded-lg text-sm text-white transition-colors"><!> Add Action</button></div> <!> <!></section> <section class="bg-gray-800/50 rounded-xl p-6"><h2 class="text-lg font-semibold text-white mb-4">Execution Log</h2> <!></section></div>');function ta(J,l){$(l,!0);let T=Tt(!1),g=Tt(te({serviceId:"",name:"",actionType:"fly-api",config:"{}"}));function G(a){switch(a){case"healthy":case"success":return"text-green-400";case"degraded":case"running":return"text-yellow-400";case"down":case"failure":return"text-red-400";default:return"text-gray-400"}}function Q(a){switch(a){case"fly-api":return ce;case"github-workflow":return me;case"ssh-command":return pe;default:return Ot}}function C(a){if(!a)return"Never";const r=new Date(a),i=new Date().getTime()-r.getTime(),u=Math.floor(i/6e4),v=Math.floor(i/36e5);return u<1?"Just now":u<60?`${u}m ago`:v<24?`${v}h ago`:r.toLocaleDateString()}let L=Ct(()=>{const a=new Set;for(const r of l.data.health.services)a.add(r.id);return Array.from(a).sort()});var et=De();se("1p5hgyd",a=>{ee(()=>{ae.title="Infrastructure | Orchon Admin"})});var at=e(et),rt=s(e(at),2);rt.__click=()=>ne();var qt=e(rt);jt(qt,{class:"w-4 h-4"}),K(),t(rt),t(at);var yt=s(at,2);{var Ht=a=>{var r=ge(),c=e(r,!0);t(r),z(()=>b(c,l.form.message||"Action completed successfully")),d(a,r)};y(yt,a=>{l.form?.success&&a(Ht)})}var wt=s(yt,2);{var Gt=a=>{var r=fe(),c=e(r,!0);t(r),z(()=>b(c,l.form.error)),d(a,r)};y(wt,a=>{l.form?.error&&a(Gt)})}var st=s(wt,2),ot=e(st),Et=e(ot);le(Et,{class:"w-5 h-5 text-gray-400"}),K(2),t(ot);var kt=s(ot,2),Ft=e(kt);{var Jt=a=>{var r=_e(),c=H(r);pt(c,{class:"w-6 h-6 text-green-400"}),K(2),d(a,r)},Lt=a=>{var r=he(),c=H(r);gt(c,{class:"w-6 h-6 text-red-400"});var i=s(c,4);{var u=v=>{var f=xe(),h=e(f);t(f),z(()=>b(h,`(${l.data.health.database.message??""})`)),d(v,f)};y(i,v=>{l.data.health.database.message&&v(u)})}d(a,r)};y(Ft,a=>{l.data.health.database.connected?a(Jt):a(Lt,!1)})}t(kt),t(st);var it=s(st,2),zt=s(e(it),2);{var Bt=a=>{var r=be();d(a,r)},Wt=a=>{var r=we();X(r,21,()=>l.data.health.services,Y,(c,i)=>{var u=ye(),v=e(u),f=e(v),h=e(f),E=e(h,!0);t(h);var w=s(h,2),k=e(w,!0);t(w),t(f);var j=s(f,2),N=e(j);{var R=n=>{pt(n,{class:"w-5 h-5 text-green-400"})},P=n=>{var x=B(),D=H(x);{var M=q=>{ue(q,{class:"w-5 h-5 text-yellow-400"})},A=q=>{var U=B(),vt=H(U);{var ct=W=>{gt(W,{class:"w-5 h-5 text-red-400"})},F=W=>{Rt(W,{class:"w-5 h-5 text-gray-500"})};y(vt,W=>{o(i).status==="down"?W(ct):W(F,!1)},!0)}d(q,U)};y(D,q=>{o(i).status==="degraded"?q(M):q(A,!1)},!0)}d(n,x)};y(N,n=>{o(i).status==="healthy"?n(R):n(P,!1)})}t(j),t(v);var _=s(v,2),I=e(_),S=e(I,!0);t(I);var O=s(I,2),p=e(O,!0);t(O),t(_),t(u),z(n=>{b(E,o(i).id),b(k,o(i).projectName),b(S,o(i).provider),b(p,n)},[()=>C(o(i).lastChecked)]),d(c,u)}),t(r),d(a,r)};y(zt,a=>{l.data.health.services.length===0?a(Bt):a(Wt,!1)})}t(it);var nt=s(it,2),lt=e(nt),dt=s(e(lt),2);dt.__click=()=>V(T,!o(T));var Kt=e(dt);de(Kt,{class:"w-4 h-4"}),K(),t(dt),t(lt);var At=s(lt,2);{var Qt=a=>{var r=Ae(),c=e(r),i=e(c),u=s(e(i),2),v=e(u);v.value=v.__value="";var f=s(v);X(f,17,()=>o(L),Y,(n,x)=>{var D=ke(),M=e(D,!0);t(D);var A={};z(()=>{b(M,o(x)),A!==(A=o(x))&&(D.value=(D.__value=o(x))??"")}),d(n,D)}),t(u),t(i);var h=s(i,2),E=s(e(h),2);Z(E),t(h),t(c);var w=s(c,2),k=e(w),j=s(e(k),2),N=e(j);N.value=N.__value="fly-api";var R=s(N);R.value=R.__value="github-workflow";var P=s(R);P.value=P.__value="gcp-api";var _=s(P);_.value=_.__value="ssh-command",t(j),t(k);var I=s(k,2),S=s(e(I),2);Z(S),oe(S,"placeholder",'{"app": "my-app", "action": "restart"}'),t(I),t(w);var O=s(w,2),p=e(O);p.__click=()=>V(T,!1),K(2),t(O),t(r),ut(r,(n,x)=>mt?.(n,x),()=>()=>async({update:n})=>{await n(),V(T,!1),V(g,{serviceId:"",name:"",actionType:"fly-api",config:"{}"},!0)}),St(u,()=>o(g).serviceId,n=>o(g).serviceId=n),Mt(E,()=>o(g).name,n=>o(g).name=n),St(j,()=>o(g).actionType,n=>o(g).actionType=n),Mt(S,()=>o(g).config,n=>o(g).config=n),d(a,r)};y(At,a=>{o(T)&&a(Qt)})}var Ut=s(At,2);{var Vt=a=>{var r=Ie();d(a,r)},Xt=a=>{var r=Ce();X(r,21,()=>l.data.actions,Y,(c,i)=>{const u=Ct(()=>Q(o(i).actionType));var v=Te(),f=e(v),h=e(f),E=e(h);re(E,()=>o(u),(M,A)=>{A(M,{class:"w-5 h-5 text-gray-400"})}),t(h);var w=s(h,2),k=e(w),j=e(k,!0);t(k);var N=s(k,2),R=e(N,!0);t(N),t(w),t(f);var P=s(f,2),_=e(P),I=e(_);Z(I);var S=s(I,2),O=e(S);Ot(O,{class:"w-4 h-4"}),K(),t(S),t(_),ut(_,M=>mt?.(M));var p=s(_,2),n=e(p);Z(n);var x=s(n,2),D=e(x);ve(D,{class:"w-4 h-4"}),t(x),t(p),ut(p,M=>mt?.(M)),t(P),t(v),z(()=>{b(j,o(i).name),b(R,o(i).serviceId),Dt(I,o(i).id),Dt(n,o(i).id)}),d(c,v)}),t(r),d(a,r)};y(Ut,a=>{l.data.actions.length===0?a(Vt):a(Xt,!1)})}t(nt);var It=s(nt,2),Yt=s(e(It),2);{var Zt=a=>{var r=Ne();d(a,r)},$t=a=>{var r=Se();X(r,21,()=>l.data.executions,Y,(c,i)=>{var u=Pe(),v=e(u),f=e(v);{var h=p=>{pt(p,{class:"w-5 h-5"})},E=p=>{var n=B(),x=H(n);{var D=A=>{gt(A,{class:"w-5 h-5"})},M=A=>{var q=B(),U=H(q);{var vt=F=>{jt(F,{class:"w-5 h-5 animate-spin"})},ct=F=>{Rt(F,{class:"w-5 h-5"})};y(U,F=>{o(i).status==="running"?F(vt):F(ct,!1)},!0)}d(A,q)};y(x,A=>{o(i).status==="failure"?A(D):A(M,!1)},!0)}d(p,n)};y(f,p=>{o(i).status==="success"?p(h):p(E,!1)})}t(v);var w=s(v,2),k=e(w),j=e(k,!0);t(k);var N=s(k,2),R=e(N,!0);t(N),t(w);var P=s(w,2),_=e(P),I=e(_,!0);t(_);var S=s(_,2),O=e(S,!0);t(S),t(P),t(u),z((p,n,x)=>{Pt(v,1,p),b(j,o(i).actionName),b(R,o(i).serviceId),Pt(_,1,n),b(I,o(i).status),b(O,x)},[()=>Nt(G(o(i).status)),()=>Nt(G(o(i).status)),()=>C(o(i).startedAt)]),d(c,u)}),t(r),d(a,r)};y(Yt,a=>{l.data.executions.length===0?a(Zt):a($t,!1)})}t(It),t(et),d(J,et),tt()}ie(["click"]);export{ta as component};
