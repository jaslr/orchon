import"../chunks/DsnmJJEf.js";import{p as Pe,s as J,a as Q,u as le,b as A,g as e,f as x,c as f,d as Te,e as M,h as Me,i as s,j as d,$ as Oe,n as O,r as t,t as N,k as de,l as ce,m as Re}from"../chunks/VB45bhtT.js";import{s as p}from"../chunks/CgppWemH.js";import{i as h}from"../chunks/CuIfUMuc.js";import{e as ve,s as Be}from"../chunks/oRfbssuc.js";import{h as Ee}from"../chunks/B2E4lz1E.js";import{s as fe}from"../chunks/Dnptkdu8.js";import{g as Fe,s as Ge,a as W}from"../chunks/B9P3TxM7.js";import{C as X}from"../chunks/33od3G62.js";import{A as Ie}from"../chunks/5nEHX2Zv.js";import{G as Y}from"../chunks/CdtQIXoB.js";import{L as qe}from"../chunks/Ci1oMc5i.js";import{E as ze}from"../chunks/C0Iw7LoP.js";import{C as He,a as Ke}from"../chunks/Bgf0s5Dt.js";var Ve=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-sm">No recent deployments</p></div>'),Je=x('<a class="flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 transition-colors"><div class="shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-white truncate"> </span> <span> </span></div> <div class="text-xs text-gray-500 truncate"> </div></div> <div class="shrink-0 text-xs text-gray-500"> </div></a>'),Qe=x('<div class="divide-y divide-gray-800"></div>'),We=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-sm">No recent commits</p></div>'),Xe=x('<span class="text-xs text-gray-500 font-mono"> </span>'),Ye=x('<span class="font-mono"> </span>'),Ze=x('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 transition-colors"><div class="shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-white truncate"> </span> <!></div> <div class="text-xs text-gray-500 truncate"><!></div></div> <div class="shrink-0 flex items-center gap-2 text-xs text-gray-500"><span> </span> <!></div></a>'),$e=x('<div class="divide-y divide-gray-800"></div>'),ea=x('<div class="flex-1 flex flex-col lg:flex-row min-h-0 h-full overflow-hidden gap-4 lg:gap-6 p-4"><div class="flex-1 flex flex-col border border-gray-800 rounded-lg min-w-0 overflow-hidden"><div class="shrink-0 px-4 py-3 border-b border-gray-800 flex items-center justify-between"><div class="flex items-center gap-2 text-gray-400"><!> <span class="text-sm font-medium">Recent Deployments</span></div> <a href="/deployments" class="text-xs text-gray-500 hover:text-gray-300 flex items-center gap-1">View all <!></a></div> <div class="flex-1 overflow-y-auto"><!></div></div> <div class="flex-1 flex flex-col border border-gray-800 rounded-lg min-w-0 overflow-hidden"><div class="shrink-0 px-4 py-3 border-b border-gray-800 flex items-center justify-between"><div class="flex items-center gap-2 text-gray-400"><!> <span class="text-sm font-medium">Recent Commits</span></div></div> <div class="flex-1 overflow-y-auto"><!></div></div></div>');function pa(ue,c){Pe(c,!0);const Z=Fe();let P=J(Q(Z?.statuses||c.data.statuses)),$=J(Q(Z?.lastUpdated||c.data.lastUpdated)),R=J(Q(c.data.deploymentLog||[])),ee=M(()=>[...e(P)].filter(r=>r.lastPush).sort((r,i)=>{const o=new Date(r.lastPush||0).getTime();return new Date(i.lastPush||0).getTime()-o}).slice(0,20));le(()=>{c.data.statuses&&c.data.statuses.length>0&&(A(P,c.data.statuses,!0),A($,c.data.lastUpdated,!0),Ge(c.data.statuses,c.data.lastUpdated)),c.data.deploymentLog&&A(R,c.data.deploymentLog,!0)});const me="https://observatory-backend.fly.dev";let pe=M(()=>c.data.apiSecret||"");le(()=>{W.connect(me,e(pe));const r=W.subscribe(i=>{if(i.type==="deployment"&&i.project){const o=i.data;xe(i.project,o)}});return()=>{r(),W.disconnect()}});function xe(r,i){A($,new Date().toISOString(),!0),A(P,e(P).map(o=>{if(o.repo===r||o.repo.toLowerCase()===r.toLowerCase()){let a;switch(i.status){case"success":a="success";break;case"failure":a="failure";break;case"in_progress":case"queued":a="deploying";break;default:a="unknown"}return{...o,deployStatus:a,deployedAt:new Date().toISOString(),deployUrl:i.runUrl||o.deployUrl,run_date:new Date().toISOString()}}return o}),!0)}function ae(r){if(!r)return"";const i=new Date(r),a=new Date().getTime()-i.getTime(),u=Math.floor(a/6e4),v=Math.floor(a/36e5),m=Math.floor(a/864e5);return u<1?"just now":u<60?`${u}m ago`:v<24?`${v}h ago`:m<7?`${m}d ago`:i.toLocaleDateString()}function _e(r){switch(r){case"success":return"text-green-400";case"failure":return"text-red-400";case"deploying":return"text-cyan-400";default:return"text-gray-400"}}function ge(r){switch(r){case"success":return"Deployed";case"failure":return"Failed";case"deploying":return"Deploying";default:return"Unknown"}}var B=ea();Ee("1uha8ag",r=>{Me(()=>{Oe.title="Console | Orchon"})});var E=s(B),F=s(E),G=s(F),he=s(G);X(he,{class:"w-4 h-4"}),O(2),t(G);var te=d(G,2),ye=d(s(te));Ie(ye,{class:"w-3 h-3"}),t(te),t(F);var re=d(F,2),we=s(re);{var be=r=>{var i=Ve(),o=s(i);X(o,{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),O(2),t(i),f(r,i)},ke=r=>{var i=Qe();ve(i,21,()=>e(R),o=>o.id,(o,a)=>{const u=M(()=>e(a).deployCompletedAt||e(a).completedAt||e(a).startedAt),v=M(()=>e(a).status==="success"?"success":e(a).status==="failure"?"failure":e(a).status==="in_progress"?"deploying":"unknown");var m=Je(),_=s(m),k=s(_);{var D=n=>{qe(n,{class:"w-5 h-5 text-cyan-400 animate-spin"})},q=n=>{var l=de(),g=ce(l);{var V=w=>{He(w,{class:"w-5 h-5 text-green-400"})},Ue=w=>{var ne=de(),je=ce(ne);{var Ae=b=>{Ke(b,{class:"w-5 h-5 text-red-400"})},Ne=b=>{X(b,{class:"w-5 h-5 text-gray-500"})};h(je,b=>{e(v)==="failure"?b(Ae):b(Ne,!1)},!0)}f(w,ne)};h(g,w=>{e(v)==="success"?w(V):w(Ue,!1)},!0)}f(n,l)};h(k,n=>{e(v)==="deploying"?n(D):n(q,!1)})}t(_);var C=d(_,2),S=s(C),y=s(S),z=s(y,!0);t(y);var L=d(y,2),H=s(L,!0);t(L),t(S);var U=d(S,2),j=s(U);t(U),t(C);var T=d(C,2),K=s(T,!0);t(T),t(m),N((n,l,g)=>{fe(m,"href",`/deployments?project=${e(a).projectName??""}`),p(z,e(a).projectDisplayName||e(a).projectName),Be(L,1,`text-xs ${n??""}`),p(H,l),p(j,`${e(a).provider??""} ${e(a).branch?`â€¢ ${e(a).branch}`:""}`),p(K,g)},[()=>_e(e(v)),()=>ge(e(v)),()=>ae(e(u))]),f(o,m)}),t(i),f(r,i)};h(we,r=>{e(R).length===0?r(be):r(ke,!1)})}t(re),t(E);var se=d(E,2),I=s(se),ie=s(I),De=s(ie);Y(De,{class:"w-4 h-4"}),O(2),t(ie),t(I);var oe=d(I,2),Ce=s(oe);{var Se=r=>{var i=We(),o=s(i);Y(o,{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),O(2),t(i),f(r,i)},Le=r=>{var i=$e();ve(i,21,()=>e(ee),o=>o.repo+o.lastPush,(o,a)=>{var u=Ze(),v=s(u),m=s(v);Y(m,{class:"w-5 h-5 text-gray-400"}),t(v);var _=d(v,2),k=s(_),D=s(k),q=s(D,!0);t(D);var C=d(D,2);{var S=n=>{var l=Xe(),g=s(l,!0);t(l),N(()=>p(g,e(a).version)),f(n,l)};h(C,n=>{e(a).version&&n(S)})}t(k);var y=d(k,2),z=s(y);{var L=n=>{var l=Ye(),g=s(l,!0);t(l),N(V=>p(g,V),[()=>e(a).lastCommitSha.slice(0,7)]),f(n,l)},H=n=>{var l=Re();N(()=>p(l,`Pushed to ${e(a).owner??""}/${e(a).repo??""}`)),f(n,l)};h(z,n=>{e(a).lastCommitSha?n(L):n(H,!1)})}t(y),t(_);var U=d(_,2),j=s(U),T=s(j,!0);t(j);var K=d(j,2);ze(K,{class:"w-3 h-3"}),t(U),t(u),N(n=>{fe(u,"href",e(a).repoUrl),p(q,e(a).repo),p(T,n)},[()=>ae(e(a).lastPush)]),f(o,u)}),t(i),f(r,i)};h(Ce,r=>{e(ee).length===0?r(Se):r(Le,!1)})}t(oe),t(se),t(B),f(ue,B),Te()}export{pa as component};
