import"../chunks/DsnmJJEf.js";import{p as oe,d as ie,c as G,b as q,a as v,n as _e,an as ee,a9 as ae,x as pe,aa as R,A as e,f as x,am as F,J as Ee,F as s,I as c,ao as Fe,al as z,G as t,D as B,ap as ze}from"../chunks/3lJB4T0S.js";import{s as ge,a as m}from"../chunks/BqZwnDtf.js";import{i as w}from"../chunks/BkU7iF2q.js";import{I as he,e as me,s as xe,a as Ge}from"../chunks/Dq9r9tkR.js";import{h as qe,C as te}from"../chunks/DL8kRa9u.js";import{s as re}from"../chunks/BLtbU3fE.js";import{g as He,s as Je}from"../chunks/BL3PLj43.js";import{s as ye,r as we}from"../chunks/53_MOYEh.js";import{L as Ke}from"../chunks/DIT1yhw6.js";import{E as Ve}from"../chunks/C1MZzrQL.js";import{C as Qe,a as We}from"../chunks/CQyleI3m.js";function Xe(L,n){oe(n,!0);let b=we(n,["$$slots","$$events","$$legacy"]);const _=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];he(L,ye({name:"arrow-right"},()=>b,{get iconNode(){return _},children:(D,U)=>{var g=G(),N=q(g);ge(N,()=>n.children??_e),v(D,g)},$$slots:{default:!0}})),ie()}function se(L,n){oe(n,!0);let b=we(n,["$$slots","$$events","$$legacy"]);const _=[["circle",{cx:"12",cy:"12",r:"3"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12"}]];he(L,ye({name:"git-commit-horizontal"},()=>b,{get iconNode(){return _},children:(D,U)=>{var g=G(),N=q(g);ge(N,()=>n.children??_e),v(D,g)},$$slots:{default:!0}})),ie()}var Ye=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-sm">No recent deployments</p></div>'),Ze=x('<a class="flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 transition-colors"><div class="shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-white truncate"> </span> <span> </span></div> <div class="text-xs text-gray-500 truncate"> </div></div> <div class="shrink-0 text-xs text-gray-500"> </div></a>'),$e=x('<div class="divide-y divide-gray-800"></div>'),ea=x('<div class="p-8 text-center text-gray-500"><!> <p class="text-sm">No recent commits</p></div>'),aa=x('<span class="text-xs text-gray-500 font-mono"> </span>'),ta=x('<span class="font-mono"> </span>'),ra=x('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-4 py-3 hover:bg-gray-800/50 transition-colors"><div class="shrink-0"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-white truncate"> </span> <!></div> <div class="text-xs text-gray-500 truncate"><!></div></div> <div class="shrink-0 flex items-center gap-2 text-xs text-gray-500"><span> </span> <!></div></a>'),sa=x('<div class="divide-y divide-gray-800"></div>'),oa=x('<div class="flex-1 flex flex-col lg:flex-row min-h-0 h-full overflow-hidden gap-4 lg:gap-6 p-4"><div class="flex-1 flex flex-col border border-gray-800 rounded-lg min-w-0 overflow-hidden"><div class="shrink-0 px-4 py-3 border-b border-gray-800 flex items-center justify-between"><div class="flex items-center gap-2 text-gray-400"><!> <span class="text-sm font-medium">Recent Deployments</span></div> <a href="/deployments" class="text-xs text-gray-500 hover:text-gray-300 flex items-center gap-1">View all <!></a></div> <div class="flex-1 overflow-y-auto"><!></div></div> <div class="flex-1 flex flex-col border border-gray-800 rounded-lg min-w-0 overflow-hidden"><div class="shrink-0 px-4 py-3 border-b border-gray-800 flex items-center justify-between"><div class="flex items-center gap-2 text-gray-400"><!> <span class="text-sm font-medium">Recent Commits</span></div></div> <div class="flex-1 overflow-y-auto"><!></div></div></div>');function ga(L,n){oe(n,!0);const b=He();let _=ee(ae(b?.statuses||n.data.statuses)),D=ee(ae(b?.lastUpdated||n.data.lastUpdated)),U=ee(ae(n.data.deploymentLog||[])),g=F(()=>[...e(_)].filter(r=>r.lastPush).sort((r,o)=>{const i=new Date(r.lastPush||0).getTime();return new Date(o.lastPush||0).getTime()-i}).slice(0,20));pe(()=>{n.data.statuses&&n.data.statuses.length>0&&(R(_,n.data.statuses,!0),R(D,n.data.lastUpdated,!0),Je(n.data.statuses,n.data.lastUpdated)),n.data.deploymentLog&&R(U,n.data.deploymentLog,!0)});const N="https://observatory-backend.fly.dev";let be=F(()=>n.data.apiSecret||"");pe(()=>{re.connect(N,e(be));const r=re.subscribe(o=>{if(o.type==="deployment"&&o.project){const i=o.data;De(o.project,i)}});return()=>{r(),re.disconnect()}});function De(r,o){R(D,new Date().toISOString(),!0),R(_,e(_).map(i=>{if(i.repo===r||i.repo.toLowerCase()===r.toLowerCase()){let a;switch(o.status){case"success":a="success";break;case"failure":a="failure";break;case"in_progress":case"queued":a="deploying";break;default:a="unknown"}return{...i,deployStatus:a,deployedAt:new Date().toISOString(),deployUrl:o.runUrl||i.deployUrl,run_date:new Date().toISOString()}}return i}),!0)}function ne(r){if(!r)return"";const o=new Date(r),a=new Date().getTime()-o.getTime(),u=Math.floor(a/6e4),f=Math.floor(a/36e5),p=Math.floor(a/864e5);return u<1?"just now":u<60?`${u}m ago`:f<24?`${f}h ago`:p<7?`${p}d ago`:o.toLocaleDateString()}function ke(r){switch(r){case"success":return"text-green-400";case"failure":return"text-red-400";case"deploying":return"text-cyan-400";default:return"text-gray-400"}}function Ce(r){switch(r){case"success":return"Deployed";case"failure":return"Failed";case"deploying":return"Deploying";default:return"Unknown"}}var H=oa();qe("1uha8ag",r=>{Ee(()=>{Fe.title="Console | Orchon"})});var J=s(H),K=s(J),V=s(K),Se=s(V);te(Se,{class:"w-4 h-4"}),z(2),t(V);var le=c(V,2),Le=c(s(le));Xe(Le,{class:"w-3 h-3"}),t(le),t(K);var de=c(K,2),Ue=s(de);{var Ne=r=>{var o=Ye(),i=s(o);te(i,{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),z(2),t(o),v(r,o)},Ae=r=>{var o=$e();me(o,21,()=>e(U),i=>i.id,(i,a)=>{const u=F(()=>e(a).deployCompletedAt||e(a).completedAt||e(a).startedAt),f=F(()=>e(a).status==="success"?"success":e(a).status==="failure"?"failure":e(a).status==="in_progress"?"deploying":"unknown");var p=Ze(),h=s(p),A=s(h);{var j=l=>{Ke(l,{class:"w-5 h-5 text-cyan-400 animate-spin"})},W=l=>{var d=G(),y=q(d);{var $=C=>{Qe(C,{class:"w-5 h-5 text-green-400"})},Ie=C=>{var ue=G(),Oe=q(ue);{var Re=S=>{We(S,{class:"w-5 h-5 text-red-400"})},Be=S=>{te(S,{class:"w-5 h-5 text-gray-500"})};w(Oe,S=>{e(f)==="failure"?S(Re):S(Be,!1)},!0)}v(C,ue)};w(y,C=>{e(f)==="success"?C($):C(Ie,!1)},!0)}v(l,d)};w(A,l=>{e(f)==="deploying"?l(j):l(W,!1)})}t(h);var P=c(h,2),M=s(P),k=s(M),X=s(k,!0);t(k);var T=c(k,2),Y=s(T,!0);t(T),t(M);var I=c(M,2),O=s(I);t(I),t(P);var E=c(P,2),Z=s(E,!0);t(E),t(p),B((l,d,y)=>{xe(p,"href",`/deployments?project=${e(a).projectName??""}`),m(X,e(a).projectDisplayName||e(a).projectName),Ge(T,1,`text-xs ${l??""}`),m(Y,d),m(O,`${e(a).provider??""} ${e(a).branch?`â€¢ ${e(a).branch}`:""}`),m(Z,y)},[()=>ke(e(f)),()=>Ce(e(f)),()=>ne(e(u))]),v(i,p)}),t(o),v(r,o)};w(Ue,r=>{e(U).length===0?r(Ne):r(Ae,!1)})}t(de),t(J);var ce=c(J,2),Q=s(ce),ve=s(Q),je=s(ve);se(je,{class:"w-4 h-4"}),z(2),t(ve),t(Q);var fe=c(Q,2),Pe=s(fe);{var Me=r=>{var o=ea(),i=s(o);se(i,{class:"w-8 h-8 mx-auto mb-2 opacity-50"}),z(2),t(o),v(r,o)},Te=r=>{var o=sa();me(o,21,()=>e(g),i=>i.repo+i.lastPush,(i,a)=>{var u=ra(),f=s(u),p=s(f);se(p,{class:"w-5 h-5 text-gray-400"}),t(f);var h=c(f,2),A=s(h),j=s(A),W=s(j,!0);t(j);var P=c(j,2);{var M=l=>{var d=aa(),y=s(d,!0);t(d),B(()=>m(y,e(a).version)),v(l,d)};w(P,l=>{e(a).version&&l(M)})}t(A);var k=c(A,2),X=s(k);{var T=l=>{var d=ta(),y=s(d,!0);t(d),B($=>m(y,$),[()=>e(a).lastCommitSha.slice(0,7)]),v(l,d)},Y=l=>{var d=ze();B(()=>m(d,`Pushed to ${e(a).owner??""}/${e(a).repo??""}`)),v(l,d)};w(X,l=>{e(a).lastCommitSha?l(T):l(Y,!1)})}t(k),t(h);var I=c(h,2),O=s(I),E=s(O,!0);t(O);var Z=c(O,2);Ve(Z,{class:"w-3 h-3"}),t(I),t(u),B(l=>{xe(u,"href",e(a).repoUrl),m(W,e(a).repo),m(E,l)},[()=>ne(e(a).lastPush)]),v(i,u)}),t(o),v(r,o)};w(Pe,r=>{e(g).length===0?r(Me):r(Te,!1)})}t(fe),t(ce),t(H),v(L,H),ie()}export{ga as component};
