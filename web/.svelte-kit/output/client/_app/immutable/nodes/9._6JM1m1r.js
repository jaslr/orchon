import"../chunks/DsnmJJEf.js";import{h as Xt,j as Kt,aq as Wt,k as Yt,p as gt,d as mt,c as U,b as z,a as d,n as Zt,an as K,a9 as ut,x as dt,aa as L,A as e,f as p,I as u,F as n,D as w,J as te,ao as ee,G as o,am as F}from"../chunks/iEcfl4Zz.js";import{B as re,s as ae,d as se,a as h}from"../chunks/4ArvJHEk.js";import{i as b}from"../chunks/CK54UOYh.js";import{I as oe,e as W,c as ne,i as ft,d as ie,a as _t,s as xt}from"../chunks/7rkDPlKJ.js";import{h as le,C as pt}from"../chunks/DgAUzZTY.js";import{g as ce}from"../chunks/Ca1PA8un.js";import{s as ve,r as ue}from"../chunks/CMf16_yh.js";import{X as de}from"../chunks/LN5qzXlw.js";import{C as fe}from"../chunks/FZHiLi6P.js";import{L as _e}from"../chunks/CdGRohIx.js";import{G as xe}from"../chunks/BnRnjDSQ.js";import{E as pe}from"../chunks/M1V3mCm3.js";import{C as ge,a as me}from"../chunks/D4r3jmnC.js";function he($,g,f){Xt&&Kt();var m=new re($),k=!Wt();Yt(()=>{var A=g();k&&A!==null&&typeof A=="object"&&(A={}),m.ensure(A,f)})}function be($,g){gt(g,!0);let f=ue(g,["$$slots","$$events","$$legacy"]);const m=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"}]];oe($,ve({name:"funnel"},()=>f,{get iconNode(){return m},children:(k,A)=>{var S=U(),G=z(S);ae(G,()=>g.children??Zt),d(k,S)},$$slots:{default:!0}})),mt()}var we=p("<option> </option>"),ye=p('<button class="flex items-center gap-1 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-500 transition-colors"> <!></button>'),ke=p('<button class="px-2 py-0.5 text-xs bg-gray-800 hover:bg-gray-700 text-gray-400 hover:text-white rounded transition-colors"> </button>'),Ae=p('<div class="flex flex-wrap items-center gap-2"><span class="text-xs text-gray-500">Recent:</span> <!></div>'),De=p('<p class="text-sm mt-1">Try selecting a different project or clear the filter</p>'),Te=p('<div class="p-8 text-center text-gray-500"><!> <p class="text-lg">No deployments found</p> <!></div>'),Se=p('<span class="flex items-center gap-1"><!> </span>'),je=p('<a target="_blank" rel="noopener noreferrer" class="font-mono text-xs hover:text-blue-400 transition-colors"> </a>'),Ce=p('<a target="_blank" rel="noopener noreferrer" class="flex items-center gap-1 hover:text-blue-400 transition-colors">View logs <!></a>'),Me=p("<div> </div>"),$e=p('<div class="text-xs text-gray-600 mt-0.5"> </div>'),Le=p('<div class="px-4 py-4 hover:bg-gray-800/30 transition-colors"><div class="flex items-start gap-4"><div class="shrink-0 mt-0.5"><!></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 flex-wrap"><button class="font-medium text-white hover:text-blue-400 transition-colors"> </button> <span> </span> <span class="text-xs text-gray-600 capitalize"> </span></div> <div class="flex items-center gap-4 mt-1.5 text-sm text-gray-500"><!> <!> <!></div></div> <div class="shrink-0 text-right"><div class="flex items-center gap-1.5 text-sm text-gray-400"><!> </div> <!></div></div></div>'),Ie=p('<div class="divide-y divide-gray-800"></div>'),Pe=p('<div class="flex-1 flex flex-col h-full overflow-hidden"><div class="shrink-0 px-4 py-4 border-b border-gray-800 bg-gray-900/50"><div class="flex flex-col gap-3"><div class="flex items-center justify-between"><h1 class="text-lg font-semibold text-white">Deployment Log</h1> <span class="text-sm text-gray-500"> </span></div> <div class="flex flex-wrap items-center gap-2"><!> <select class="bg-gray-800 border border-gray-700 rounded px-3 py-1.5 text-sm text-gray-300 focus:outline-none focus:border-blue-500"><option>All Projects</option><!></select> <!></div> <!></div></div> <div class="flex-1 overflow-y-auto"><!></div></div>');function Xe($,g){gt(g,!0);let f=K(ut(g.data.projectFilter)),m=K(ut([]));dt(()=>{{const t=localStorage.getItem("orchon-recent-project-filters");if(t)try{L(m,JSON.parse(t),!0)}catch{L(m,[],!0)}}});let k=F(()=>[...e(f)?g.data.deployments.filter(r=>r.projectName===e(f)):g.data.deployments].sort((r,a)=>{const s=r.status==="in_progress"||r.status==="queued",c=a.status==="in_progress"||a.status==="queued";if(s&&!c)return-1;if(!s&&c)return 1;const v=new Date(r.deployCompletedAt||r.completedAt||r.startedAt||0).getTime();return new Date(a.deployCompletedAt||a.completedAt||a.startedAt||0).getTime()-v}));function A(t){return g.data.projects.find(a=>a.id===t)?.name||t}function S(t){L(f,t,!0);{const r=new URL(window.location.href);t?r.searchParams.set("project",t):r.searchParams.delete("project"),ce(r.toString(),{replaceState:!0,noScroll:!0}),t&&!e(m).includes(t)&&(L(m,[t,...e(m).filter(a=>a!==t)].slice(0,5),!0),localStorage.setItem("orchon-recent-project-filters",JSON.stringify(e(m))))}}function G(t){if(!t)return"Unknown";const r=new Date(t),s=new Date().getTime()-r.getTime(),c=Math.floor(s/6e4),v=Math.floor(s/36e5),_=Math.floor(s/864e5);return c<1?"just now":c<60?`${c}m ago`:v<24?`${v}h ago`:_<7?`${_}d ago`:r.toLocaleDateString()}function ht(t){return t?new Date(t).toLocaleString():""}function bt(t){switch(t){case"success":return"text-green-400";case"failure":return"text-red-400";case"in_progress":return"text-cyan-400";default:return"text-gray-400"}}function wt(t){switch(t){case"success":return"Success";case"failure":return"Failed";case"in_progress":return"Deploying";case"queued":return"Queued";default:return"Unknown"}}function Y(t){const r=Math.floor(t/1e3),a=Math.floor(r/60),s=Math.floor(a/60);return s>0?`${s}h ${a%60}m`:a>0?`${a}m ${r%60}s`:`${r}s`}function yt(t){const r=t.status,a=t.ciStartedAt||t.startedAt,s=t.deployCompletedAt||t.completedAt;if(r==="in_progress"||r==="queued"){if(!a)return null;const c=new Date(a).getTime(),v=Date.now()-c;return{text:`running ${Y(v)}`,color:"text-cyan-400"}}else if(r==="success"||r==="failure"){if(!a||!s)return null;const c=new Date(a).getTime(),_=new Date(s).getTime()-c;if(_<0)return null;const j=r==="failure"?"failed after":"took",I=r==="failure"?"text-red-400":"text-green-400";return{text:`${j} ${Y(_)}`,color:I}}return null}let J=K(0);dt(()=>{{const t=setInterval(()=>{L(J,e(J)+1)},1e4);return()=>clearInterval(t)}});var N=Pe();le("1tckhxz",t=>{te(()=>{ee.title="Deployments | Orchon"})});var O=n(N),Z=n(O),R=n(Z),tt=u(n(R),2),kt=n(tt);o(tt),o(R);var B=u(R,2),et=n(B);be(et,{class:"w-4 h-4 text-gray-500 shrink-0"});var D=u(et,2);D.__change=t=>S(t.currentTarget.value||null);var E=n(D);E.value=E.__value="";var At=u(E);W(At,17,()=>g.data.projects,ft,(t,r)=>{var a=we(),s=n(a,!0);o(a);var c={};w(()=>{h(s,e(r).name),c!==(c=e(r).id)&&(a.value=(a.__value=e(r).id)??"")}),d(t,a)}),o(D);var rt;ne(D);var Dt=u(D,2);{var Tt=t=>{var r=ye();r.__click=()=>S(null);var a=n(r),s=u(a);de(s,{class:"w-3 h-3"}),o(r),w(c=>h(a,`${c??""} `),[()=>A(e(f))]),d(t,r)};b(Dt,t=>{e(f)&&t(Tt)})}o(B);var St=u(B,2);{var jt=t=>{var r=Ae(),a=u(n(r),2);W(a,17,()=>e(m),ft,(s,c)=>{var v=ke();v.__click=()=>S(e(c));var _=n(v,!0);o(v),w(j=>h(_,j),[()=>A(e(c))]),d(s,v)}),o(r),d(t,r)};b(St,t=>{e(m).length>0&&!e(f)&&t(jt)})}o(Z),o(O);var at=u(O,2),Ct=n(at);{var Mt=t=>{var r=Te(),a=n(r);pt(a,{class:"w-12 h-12 mx-auto mb-3 opacity-50"});var s=u(a,4);{var c=v=>{var _=De();d(v,_)};b(s,v=>{e(f)&&v(c)})}o(r),d(t,r)},$t=t=>{var r=Ie();W(r,21,()=>e(k),a=>a.id,(a,s)=>{const c=F(()=>e(s).deployCompletedAt||e(s).completedAt||e(s).startedAt),v=F(()=>e(s).status),_=F(()=>yt(e(s)));var j=Le(),I=n(j),H=n(I),Lt=n(H);{var It=i=>{_e(i,{class:"w-5 h-5 text-cyan-400 animate-spin"})},Pt=i=>{var l=U(),x=z(l);{var y=T=>{ge(T,{class:"w-5 h-5 text-green-400"})},C=T=>{var vt=U(),Ht=z(vt);{var Qt=M=>{me(M,{class:"w-5 h-5 text-red-400"})},Vt=M=>{pt(M,{class:"w-5 h-5 text-gray-500"})};b(Ht,M=>{e(v)==="failure"?M(Qt):M(Vt,!1)},!0)}d(T,vt)};b(x,T=>{e(v)==="success"?T(y):T(C,!1)},!0)}d(i,l)};b(Lt,i=>{e(v)==="in_progress"?i(It):i(Pt,!1)})}o(H);var Q=u(H,2),V=n(Q),P=n(V);P.__click=()=>S(e(s).projectName);var qt=n(P,!0);o(P);var q=u(P,2),Ft=n(q,!0);o(q);var st=u(q,2),Ut=n(st,!0);o(st),o(V);var ot=u(V,2),nt=n(ot);{var zt=i=>{var l=Se(),x=n(l);xe(x,{class:"w-3.5 h-3.5"});var y=u(x);o(l),w(()=>h(y,` ${e(s).branch??""}`)),d(i,l)};b(nt,i=>{e(s).branch&&i(zt)})}var it=u(nt,2);{var Gt=i=>{var l=je(),x=n(l,!0);o(l),w(y=>{xt(l,"href",`https://github.com/jaslr/${e(s).projectName??""}/commit/${e(s).commitSha??""}`),h(x,y)},[()=>e(s).commitSha.slice(0,7)]),d(i,l)};b(it,i=>{e(s).commitSha&&i(Gt)})}var Jt=u(it,2);{var Nt=i=>{var l=Ce(),x=u(n(l));pe(x,{class:"w-3 h-3"}),o(l),w(()=>xt(l,"href",e(s).runUrl)),d(i,l)};b(Jt,i=>{e(s).runUrl&&i(Nt)})}o(ot),o(Q);var lt=u(Q,2),X=n(lt),ct=n(X);fe(ct,{class:"w-3.5 h-3.5"});var Ot=u(ct);o(X);var Rt=u(X,2);{var Bt=i=>{var l=U(),x=z(l);he(x,()=>e(J),y=>{var C=Me(),T=n(C,!0);o(C),w(()=>{_t(C,1,`text-xs font-medium mt-0.5 ${e(_).color??""}`),h(T,e(_).text)}),d(y,C)}),d(i,l)},Et=i=>{var l=$e(),x=n(l,!0);o(l),w(y=>h(x,y),[()=>ht(e(c))]),d(i,l)};b(Rt,i=>{e(_)?i(Bt):i(Et,!1)})}o(lt),o(I),o(j),w((i,l,x)=>{h(qt,e(s).projectDisplayName||e(s).projectName),_t(q,1,`text-xs px-1.5 py-0.5 rounded ${i??""} bg-gray-800`),h(Ft,l),h(Ut,e(s).provider),h(Ot,` ${x??""}`)},[()=>bt(e(v)),()=>wt(e(v)),()=>G(e(c))]),d(a,j)}),o(r),d(t,r)};b(Ct,t=>{e(k).length===0?t(Mt):t($t,!1)})}o(at),o(N),w(()=>{h(kt,`${e(k).length??""} deployment${e(k).length!==1?"s":""}`),rt!==(rt=e(f)||"")&&(D.value=(D.__value=e(f)||"")??"",ie(D,e(f)||""))}),d($,N),mt()}se(["change","click"]);export{Xe as component};
